<?xml version="1.0" encoding="utf-8"?>
<Settings>
  <!-- ################################################################################################################################# -->
  <!-- NEW SECTION (2022/07)                                                                                                             -->
  <!-- This section create a reference table to be used through the scripts                                                              -->
  <!-- For now, only the GPO parts use this dynamic logic to fillup the migration and the preference table.                              -->
  <!--    > WellKnownID..: used to replace a dynamic pattern in a name (group, user, path, gpo, ...)                                     -->
  <!--    > Keyword......: used to shorten a word in a name (group, user, path, gpo, ...), helping in avoiding too long name in AD       -->
  <!-- ################################################################################################################################# -->
  <Translation>
    <wellKnownID objectClass="text" translateFrom="%AuthenticatedUsers%" translateTo="Authenticated Users" />
    <wellKnownID objectClass="text" translateFrom="%Administrators%" translateTo="Administrators" />
    <wellKnownID objectClass="text" translateFrom="%EnterpriseAdmins%" translateTo="Enterprise Admins" />
    <wellKnownID objectClass="text" translateFrom="%DomainAdmins%" translateTo="Domain Admins" />
    <wellKnownID objectClass="text" translateFrom="%SchemaAdmins%" translateTo="Schema Admins" />
    <wellKnownID objectClass="text" translateFrom="%DnsAdmins%" translateTo="DnsAdmins" />
    <wellKnownID objectClass="text" translateFrom="%RemoteDesktopUsers%" translateTo="Remote Desktop Users" />
    <wellKnownID objectClass="text" translateFrom="%domain%" translateTo="HARDEN" />
    <wellKnownID objectClass="text" translateFrom="%domaindns%" translateTo="harden.lab" />
    <wellKnownID objectClass="text" translateFrom="%RootDN%" translateTo="DC=harden,DC=lab" />
    <wellKnownID objectClass="text" translateFrom="%Users%" translateTo="Users" />
    <wellKnownID objectClass="group" translateFrom="%t0-global%" translateTo="L-S-T0" />
    <wellKnownID objectClass="group" translateFrom="%t1-global%" translateTo="L-S-T1" />
    <wellKnownID objectClass="group" translateFrom="%t2-global%" translateTo="L-S-T2" />
    <wellKnownID objectClass="group" translateFrom="%t1l-global%" translateTo="L-S-T1L" />
    <wellKnownID objectClass="group" translateFrom="%t2l-global%" translateTo="L-S-T2L" />
    <wellKnownID objectClass="group" translateFrom="%t0-managers%" translateTo="G-S-T0_Managers" />
    <wellKnownID objectClass="group" translateFrom="%pawaccess-logon%" translateTo="L-S-T0_PawAccess_Logon" />
    <wellKnownID objectClass="group" translateFrom="%pawt0-logon%" translateTo="L-S-T0_PawT0_Logon" />
    <wellKnownID objectClass="group" translateFrom="%pawt12l-logon%" translateTo="L-S-T0_PawT12L_Logon" />
    <wellKnownID objectClass="group" translateFrom="%t0-localAdmin-servers%" translateTo="L-S-T0_LocalAdmins_Servers" />
    <wellKnownID objectClass="group" translateFrom="%t0-localAdmin-workstations%" translateTo="L-S-T0_LocalAdmins_Workstations" />
    <wellKnownID objectClass="group" translateFrom="%t1-managers%" translateTo="G-S-T1_Managers" />
    <wellKnownID objectClass="group" translateFrom="%t1-administrators%" translateTo="G-S-T1_Administrators" />
    <wellKnownID objectClass="group" translateFrom="%t1-operators%" translateTo="G-S-T1_Operators" />
    <wellKnownID objectClass="group" translateFrom="%t1-localAdmin-servers%" translateTo="L-S-T1_LocalAdmins_Servers" />
    <wellKnownID objectClass="group" translateFrom="%t2-managers%" translateTo="G-S-T2_Managers" />
    <wellKnownID objectClass="group" translateFrom="%t2-administrators%" translateTo="G-S-T2_Administrators" />
    <wellKnownID objectClass="group" translateFrom="%t2-operators%" translateTo="G-S-T2_Operators" />
    <wellKnownID objectClass="group" translateFrom="%t2-localAdmin-workstations%" translateTo="L-S-T2_LocalAdmins_Workstations" />
    <wellKnownID objectClass="group" translateFrom="%tll-operators%" translateTo="G-S-T1L_Operators" />
    <wellKnownID objectClass="group" translateFrom="%t2l-operators%" translateTo="G-S-T2L_Operators" />
    <wellKnownID objectClass="group" translateFrom="%t1l-localAdmin-servers%" translateTo="L-S-T1L_LocalAdmins_Servers" />
    <wellKnownID objectClass="group" translateFrom="%t2l-localAdmin-workstations%" translateTo="L-S-T2L_LocalAdmins_Workstations" />
    <wellKnownID objectClass="group" translateFrom="%T1-LAPS-PasswordReset%" translateTo="L-S-T1-DELEG_LAPS_PwdReset" />
    <wellKnownID objectClass="group" translateFrom="%T1-LAPS-PasswordReader%" translateTo="L-S-T1-DELEG_LAPS_PwdRead" />
    <wellKnownID objectClass="group" translateFrom="%T2-LAPS-PasswordReset%" translateTo="L-S-T2-DELEG_LAPS_PwdReset" />
    <wellKnownID objectClass="group" translateFrom="%T2-LAPS-PasswordReader%" translateTo="L-S-T2-DELEG_LAPS_PwdRead" />
    <wellKnownID objectClass="group" translateFrom="%Prefix%" translateTo="L-S" />
    <wellKnownID objectClass="group" translateFrom="%Groups_Computers%" translateTo="LocalAdmins_%ComputerName%" />
    <wellKnownID objectClass="text" translateFrom="%OU-Adm%" translateTo="_Administration" />
    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T0%" translateTo="GroupsT0" />
    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T1%" translateTo="GroupsT1" />
    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T2%" translateTo="GroupsT2" />
    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T1L%" translateTo="GroupsT1L" />
    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T2L%" translateTo="GroupsT2L" />
    <wellKnownID objectClass="text" translateFrom="%OU-PawAcs%" translateTo="PawAccess" />
    <wellKnownID objectClass="text" translateFrom="%OU-PAW-T0%" translateTo="PawT0" />
    <wellKnownID objectClass="text" translateFrom="%OU-PAW-T12L%" translateTo="PawT12L" />
    <wellKnownID objectClass="text" translateFrom="%OU-LocalAdmins%" translateTo="LocalAdmins" />
    <wellKnownID objectClass="text" translateFrom="%OU-Production-T0%" translateTo="Harden_T0" />
    <wellKnownID objectClass="text" translateFrom="%OU-Production-T12%" translateTo="Harden_T12" />
    <wellKnownID objectClass="text" translateFrom="%OU-PRD-T12-Workstations%" translateTo="Workstations" />
    <wellKnownID objectClass="text" translateFrom="%OU-PRD-T12-Servers%" translateTo="Servers" />
    <wellKnownID objectClass="text" translateFrom="%OU-Production-TL%" translateTo="Harden_TL" />
    <Keyword LongName="servers" ShortenName="Srv" />
    <Keyword LongName="server" ShortenName="Srv" />
    <Keyword LongName="workstations" ShortenName="Wks" />
    <Keyword LongName="workstation" ShortenName="Wks" />
    <Keyword LongName="services" ShortenName="Svc" />
    <Keyword LongName="service" ShortenName="Svc" />
    <Keyword LongName="accounts" ShortenName="Acct" />
    <Keyword LongName="account" ShortenName="Acct" />
    <Keyword LongName="passwords" ShortenName="Pwd" />
    <Keyword LongName="password" ShortenName="Pwd" />
    <Keyword LongName="Firewalls" ShortenName="Fwl" />
    <Keyword LongName="Firewall" ShortenName="Fwl" />
    <Keyword LongName="security" ShortenName="Secu" />
    <Keyword LongName="local" ShortenName="Loc" />
    <Keyword LongName="administrators" ShortenName="Adm" />
    <Keyword LongName="administrator" ShortenName="Adm" />
    <Keyword LongName="Operators" ShortenName="Ope" />
    <Keyword LongName="Operator" ShortenName="Ope" />
    <Keyword LongName="Managers" ShortenName="Mgr" />
    <Keyword LongName="Manager" ShortenName="Mgr" />
  </Translation>
  <GroupPolicies>
    <!-- ################################################################################################################################# -->
    <!-- The <GPO> elements list the Group Policy added (or refreshed) to the target domain.                                               -->
    <!-- Each of this Group Policy is first generated with no data (if not existing), then data is imported from its backup folder.        -->
    <!--   > BackupID...: refer to the unique ID of the backup folder                                                                      -->
    <!--   > validation.: if set to  No, the GPO is created and overwrited from its backup. Yes will only link the GPO to its targets.     -->
    <!--   > Name.......: refer to the display name, as shown in the GUI                                                                   -->
    <!--   > Description: description label, as shown in the GUI.                                                                          -->
    <!--                                                                                                                                   -->
    <!-- The <GPOMODE> will identify the Tier perimeter (for group management) and mode to be applied.                                     -->
    <!--   > Tier.......: Tier0, Tier1 or Tier2.                                                                                           -->
    <!--   > Mode.......: APPLY, DENY or BOTH. Apply create a group that limit the application scope, whereas DENY enforce the application -->
    <!--                  to everyone except the denied one. BOTH mix the two modes, enforcing application to only a scoped target group   -->
    <!--                  with an exception scope (usefull for migration or testing purpose). If mode is ommited, the mode BOTH will be    -->
    <!--                  used.                                                                                                            -->
    <!--                                                                                                                                   -->
    <!-- The <gpoDeny> ID attribute will set the specified identity with permission "Deny Execute" - you can se as many input as requiered.-->
    <!--   > ID......: use either sAMAccountName, object GUID or SID to identify the target identity to deny.                              -->
    <!--                                                                                                                                   -->
    <!-- The <gpoLink> attribute Will link the GPO to the specified target - you can use as many input as requiered.                       -->
    <!--   > Path....: DistinguishedName of the target OU where the GPO have to be linked. Use "RootDN" to refer to the DN of the domain.  -->
    <!--   > Enabled.: "Yes", "No". Teach the script to enable the link or not.                                                            -->
    <!--   > Enforced: "Yes", "No". Teach the script to enforce this stratagy to any descending GPO that normally overcome its parameters. -->
    <!--                                                                                                                                   -->
    <!-- The <GpoFilter> parameter refers to the WMI filter that should be linked to this GPO.                                             -->
    <!--   > WMI.....: the Display Name of the target WMI filter to be used (you can refer to the name section of the MOF import)          -->
    <!--                                                                                                                                   -->
    <!-- The <GpoSecurityFilter> parameter tasks the script to set "authenticated users" as read only and add a security group as new      -->
    <!-- security filter extension.                                                                                                        -->
    <!-- ################################################################################################################################# -->
    <!-- GPO GROUP SETTINGS: used to generate APPLY and DENY Group Name. Use %tier% to mark the Tier localization in the new name          -->
    <!--   > GpoName..: define the group name for applying or denying a group                                                              -->
    <GlobalGpoSettings GroupName="G-S-%tier%-GPO_%GpoName%_%mode%" Tier0="T0" Tier1="T1" Tier2="T2">
      <GpoTier0 OU="OU=GPO,OU=GroupsT0,OU=_Administration,%rootDN%" />
      <GpoTier1 OU="OU=GPO,OU=GroupsT1,OU=_Administration,%rootDN%" />
      <GpoTier2 OU="OU=GPO,OU=GroupsT2,OU=_Administration,%rootDN%" />
    </GlobalGpoSettings>
    <GPO BackupID="{DD870AA3-5A5D-4C72-A602-C9AC78ED7B32}" Validation="Yes" Name="HAD-BitLocker-TPMOnly-Enabled-Win10-11" Description="Harden AD =================== Enable BitLocker encryption with Trusted Platform Module.">
      <GpoMode Mode="BOTH" Tier="Tier0" />
      <GpoFilter WMI="Windows-Supported-OS-Clients" />
      <GpoLink Path="OU=Workstations,OU=Harden_T0,RootDN" Enabled="Yes" Enforced="Yes" />
      <GpoLink Path="OU=Workstations,OU=Harden_T12,RootDN" Enabled="Yes" Enforced="Yes" />
    </GPO>
    <GPO BackupID="{640E7540-7FCF-4B44-926C-CF38E885EDE1}" Validation="Yes" Name="HAD-BitLocker-PIN-Enabled-Win10-11" Description="Harden AD =================== Enable BitLocker encryption with Trusted Platform Module. 6-digit PIN code required.">
      <GpoMode Mode="BOTH" Tier="Tier0" />
      <GpoFilter WMI="Windows-Supported-OS-Clients" />
      <GpoLink Path="OU=Workstations,OU=Harden_T0,RootDN" Enabled="Yes" Enforced="Yes" />
      <GpoLink Path="OU=Workstations,OU=Harden_T12,RootDN" Enabled="Yes" Enforced="Yes" />
    </GPO>
    <GPO BackupID="{D71ADCFE-2648-481E-8CFC-936389800BBE}" Validation="Yes" Name="HAD-BitLocker-USB-Win10-11" Description="Harden AD =================== Enable BitLocker encryption for USB drives with a password.">
      <GpoMode Mode="BOTH" Tier="Tier0" />
      <GpoFilter WMI="Windows-Supported-OS-Clients" />
      <GpoLink Path="OU=Workstations,OU=Harden_T0,RootDN" Enabled="Yes" Enforced="Yes" />
      <GpoLink Path="OU=Workstations,OU=Harden_T12,RootDN" Enabled="Yes" Enforced="Yes" />
    </GPO>
  </GroupPolicies>
  <Sequence>
    <!-- ################################################################################################################################### -->
    <!-- the <Sequence> section define the different tasks to iterate in "sequence" (can't resist to this one).                              -->
    <!-- To deal with highlight color in display, use the ` to initiate and end a color change in your string, then use one of the three     -->
    <!-- characters specified in value AltBaseHTxt(A,B, or C) to select your color: the color will switch back to normal at the next `.      -->
    <!--			                                                                                                                               -->
    <!-- The default highlight values are those one:                                                                                         -->
    <!--   > `[my text` : magenta                                                                                                            -->
    <!--   > `(my text` : yellow                                                                                                             -->
    <!--   > `{my text` : gray                                                                                                               -->
    <!--			                                                                                                                               -->
    <!-- Some special inputs are usefull to replace value dynamically :                                                                   	 -->
    <!--	 > FileName   : replace with the value of this file                                                                                -->
    <!--	 > RootDN     : replace with domain root DN                                                                                        -->
    <!--			                                                                                                                               -->
    <!-- Each task ID is executed in sequence, based on the Number vaue (ascending). Each Task ID use the following attributes:              -->
    <!--   > Number         : Define the squence order, the lowest will be run first.                                                        -->
    <!--   > Name           : ID task name as refered in the final log output.                                                               -->
    <!--   > CallingFunction: Name of the function to be called from one of the .psm1 files present in the modules directory.                -->
    <!--   > UseParameters  : Mandatory (but could be empty). Specify parameter to pass as argument to CallingFunction.                      -->
    <!--                      Use on per parameter and sort them in sequence (your script should refer them using input ordering).           -->
    <!--   > TaskEnabled    : YES or NO. When set to NO, the tasks is disabled and will not be applied.                                      -->
    <!-- ################################################################################################################################### -->
    <!-- IMPORT GPOs                                                                                                                       -->
    <Id Number="130" Name="Import new GPO or update existing ones">
      <CallingFunction>New-GpoObject</CallingFunction>
      <UseParameters>
      </UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Import or update `(group policy objects` to the domain and link them</TaskDescription>
    </Id>
  </Sequence>
</Settings>