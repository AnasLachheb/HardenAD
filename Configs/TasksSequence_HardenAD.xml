<?xml version="1.0" encoding="utf-8"?>
<Settings>
  <!-- ################################################################################################################################### -->
  <!-- Revision: 2022/07/08 - contact@hardenad.net                                                                                         -->
  <!-- ################################################################################################################################### -->
  <OrganizationalUnits>
    <!-- The section <ouTree> handle the base model for OU creation.                                                                       -->
    <!-- When calling the function [Set-OUTree], you need to add as parameter the "OU class" name of the tree structure you want to add.   -->
    <!-- This could also be used to manage new OU generation.                                                                              -->
    <ouTree>
      <!-- CLASS: HardenAD_ADMIN                                                                                                           -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_ADMIN" Name="Administration" Description="Privileged accounts administrative OU">
        <ChildOU>
			<Name>PAW Tier 0</Name>
			<Description>Privilege Admin Worstations Tier 0</Description>
		</ChildOU>
       <ChildOU>
			<Name>PAW Tier 1</Name>
			<Description>Privilege Admin Worstations Tier 1</Description>
		</ChildOU>
        <ChildOU>
			<Name>PAW Tier 2</Name>
			<Description>Privilege Admin Worstations Tier 2</Description>
		</ChildOU>
        <ChildOU>
			<Name>PAW Tier Legacy</Name>
			<Description>Privilege Admin Worstations Tier Legacy</Description>
		</ChildOU>
		<ChildOU>
          <Name>Groups Tier 0</Name>
          <Description>Groups to manage Tier 0 objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>Local Admins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users Tier 0</Name>
          <Description>Users to manage Tier 0 objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups Tier 1</Name>
          <Description>Groups to manage Tier 1 objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>Local Admins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users Tier 1</Name>
          <Description>Users to manage Tier 1 objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups Tier 2</Name>
          <Description>Groups to manage Tier 2 objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>Local Admins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users Tier 2</Name>
          <Description>Groups to manage Tier 2 objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups Tier Legacy</Name>
          <Description>Groups to manage Legacy objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>Local Admins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users Tier Legacy</Name>
          <Description>Users to manage Legacy objects</Description>
        </ChildOU>
      </OU>

      <!-- CLASS: HardenAD_PROD-T0                                                                                                         -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_PROD-T0" Name="Harden - Tier 0" Description="Tier 0 resources">
        <ChildOU>
          <Name>Contacts</Name>
          <Description>Contacts objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups</Name>
          <Description>Groups objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Servers</Name>
          <Description>Computer objects belonging to this Tier and acting as servers</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Services</Name>
          <Description>Service accounts belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Service accounts synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled sevice accounts</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users</Name>
          <Description>User objects belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>User objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled user objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Workstations</Name>
          <Description>Computer Objects belonging to this Tier and acting as clients</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>

      </OU>

      <!-- CLASS: HardenAD_PROD-T1and2                                                                                                     -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_PROD-T1and2" Name="Harden - Tier 1 and 2" Description="Tier 1 and Tier 2 resources">
        <ChildOU>
          <Name>Contacts</Name>
          <Description>Contacts objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups</Name>
          <Description>Groups objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Servers</Name>
          <Description>Computer objects belonging to this Tier and acting as servers</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Services</Name>
          <Description>Service accounts belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Service accounts synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled sevice accounts</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users</Name>
          <Description>User objects belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>User objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled user objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Workstations</Name>
          <Description>Computer Objects belonging to this Tier and acting as clients</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>

      </OU>

      <!-- CLASS: HardenAD_PROD-LEGACY                                                                                                     -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_PROD-LEGACY" Name="Harden - Tier Legacy" Description="Legacy resources">
        <ChildOU>
          <Name>Contacts</Name>
          <Description>Contacts objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups</Name>
          <Description>Groups objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Servers</Name>
          <Description>Computer objects belonging to this Tier and acting as servers</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Services</Name>
          <Description>Service accounts belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Service accounts synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled sevice accounts</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users</Name>
          <Description>User objects belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>User objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled user objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Workstations</Name>
          <Description>Computer Objects belonging to this Tier and acting as clients</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>

      </OU>

      <!-- CLASS: PROVISIONNING-EN                                                                                                         -->
      <!-- This class generate an OU tree used for provisionning objects in a default location. This is the English Edition.               -->
      <OU Class="PROVISIONNING-EN" Name="Provisionning" Description="New objects provisionning OU">
        <ChildOU>
          <Name>Users</Name>
          <Description>New user objects</Description>
        </ChildOU>

        <ChildOU>
          <Name>Computers</Name>
          <Description>New computer objects</Description>
        </ChildOU>
      </OU>
    </ouTree>
  </OrganizationalUnits>

  <!-- ################################################################################################################################# -->
  <!-- NEW SECTION (2022/07)                                                                                                             -->
  <!-- This section push delegation ACL to designated OU                                                                                 -->
  <!-- ################################################################################################################################# -->
  <DelegationACEs>
    <!-- Administration -->
    <!-- Delegation for L-S-T1-DELEG_Group - Create and Delete (administration) -->
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups Tier 1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType=""      TargetDN="OU=Groups Tier 1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups Tier Legacy,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType=""      TargetDN="OU=Groups Tier Legacy,OU=Administration,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_Group - Create and Delete (administration) -->
    <ACL Trustee="L-S-T2-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups Tier 2,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Group - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType=""      TargetDN="OU=Groups Tier 2,OU=Administration,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_User - Create and Delete (administration) -->
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="user"  TargetDN="OU=Users Tier 1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user"  ObjectType=""      TargetDN="OU=Users Tier 1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="user"  TargetDN="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user"  ObjectType=""      TargetDN="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_User - Create and Delete (administration) -->
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="user"  TargetDN="OU=Users Tier 2,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user"  ObjectType=""      TargetDN="OU=Users Tier 2,OU=Administration,ROOTDN"/>
    <!-- Production -->
    <!-- Delegation for L-S-T1-DELEG_Computer - Create and Delete -->
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""         ObjectType="computer" TargetDN="OU=Servers,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType=""         TargetDN="OU=Servers,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""         ObjectType="computer" TargetDN="OU=Servers,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType=""         TargetDN="OU=Servers,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_User - Create and Delete -->
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""     ObjectType="user" TargetDN="OU=Services,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType=""     TargetDN="OU=Services,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""     ObjectType="user" TargetDN="OU=Services,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType=""     TargetDN="OU=Services,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_Computer - Create and Delete -->
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""         ObjectType="computer" TargetDN="OU=Workstations,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType=""         TargetDN="OU=Workstations,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""         ObjectType="computer" TargetDN="OU=Workstations,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType=""         TargetDN="OU=Workstations,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_Group - Create and Delete -->
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType=""      TargetDN="OU=Groups,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType=""      TargetDN="OU=Groups,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_contact - Create and Delete -->
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""        ObjectType="contact" TargetDN="OU=contacts,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="contact" ObjectType=""        TargetDN="OU=Contacts,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""        ObjectType="contact" TargetDN="OU=Contacts,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="contact" ObjectType=""        TargetDN="OU=Contacts,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_User - Create and Delete -->
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""     ObjectType="user" TargetDN="OU=Users,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType=""     TargetDN="OU=Users,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""     ObjectType="user" TargetDN="OU=Users,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType=""     TargetDN="OU=Users,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_Group - Manage Membership -->
    <ACL Trustee="L-S-T2-DELEG_Group - Manage Membership" Right="ReadProperty, WriteProperty" RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType="" TargetDN="OU=Groups,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Group - Manage Membership" Right="ReadProperty, WriteProperty" RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType="" TargetDN="OU=Groups,OU=Harden - Tier Legacy,ROOTDN"/>
  </DelegationACEs>

  <!-- ################################################################################################################################# -->
  <!-- NEW SECTION (2022/07)                                                                                                             -->
  <!-- This section create a reference table to be used through the scripts                                                              -->
  <!-- For now, only the GPO parts use this dynamic logic to fillup the migration and the preference table.                              -->
  <!--    > WellKnownID..: used to replace a dynamic pattern in a name (group, user, path, gpo, ...)                                     -->
  <!--    > Keyword......: used to shorten a word in a name (group, user, path, gpo, ...), helping in avoiding too long name in AD       -->
  <!-- ################################################################################################################################# -->
  <Translation>
    <wellKnownID objectClass="text"  translateFrom="%AuthenticatedUsers%"         translateTo="Authenticated Users"/>
    <wellKnownID objectClass="text"  translateFrom="%Administrators%"             translateTo="Administrators"/>
	  <wellKnownID objectClass="text"  translateFrom="%domain%"                     translateTo="FORMATION99"/>
    <wellKnownID objectClass="text"  translateFrom="%domaindns%"                  translateTo="formation99.lan"/>
    <wellKnownID objectClass="text"  translateFrom="%RemoteDesktopUsers%"         translateTo="Remote Desktop Users"/>
    <wellKnownID objectClass="group" translateFrom="%t0-managers%"                translateTo="G-S-T0_Managers"/>
    <wellKnownID objectClass="group" translateFrom="%t0-localAdmin-servers%"      translateTo="L-S-T0_LocalAdmins_Servers"/>
    <wellKnownID objectClass="group" translateFrom="%t1-managers%"                translateTo="G-S-T1_Managers"/>
    <wellKnownID objectClass="group" translateFrom="%t1-administrators%"          translateTo="G-S-T1_Administrators"/>
    <wellKnownID objectClass="group" translateFrom="%t1-operators%"               translateTo="G-S-T1_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%t1-localAdmin-servers%"      translateTo="L-S-T1_LocalAdmins_Servers"/>
    <wellKnownID objectClass="group" translateFrom="%t2-managers%"                translateTo="G-S-T2_Managers"/>
    <wellKnownID objectClass="group" translateFrom="%t2-administrators%"          translateTo="G-S-T2_Administrators"/>
    <wellKnownID objectClass="group" translateFrom="%t2-operators%"               translateTo="G-S-T2_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%t2-localAdmin-workstations%" translateTo="L-S-T2_LocalAdmins_Workstations"/>
    <wellKnownID objectClass="group" translateFrom="%tl-operators%"               translateTo="G-S-TL_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%tl-localAdmin-servers%"      translateTo="L-S-TL_LocalAdmins_Servers"/>
    <wellKnownID objectClass="group" translateFrom="%tl-localAdmin-workstations%" translateTo="L-S-TL_LocalAdmins_Workstations"/>
	  <wellKnownID objectClass="group" translateFrom="%T1-LAPS-PasswordReset%"	    translateTo="L-S-T1-DELEG_LAPS_PwdReset"/>
	  <wellKnownID objectClass="group" translateFrom="%T1-LAPS-PasswordReader%"	    translateTo="L-S-T1-DELEG_LAPS_PwdRead"/>
	  <wellKnownID objectClass="group" translateFrom="%T2-LAPS-PasswordReset%"	    translateTo="L-S-T2-DELEG_LAPS_PwdReset"/>
	  <wellKnownID objectClass="group" translateFrom="%T2-LAPS-PasswordReader%"	    translateTo="L-S-T2-DELEG_LAPS_PwdRead"/>
    
    <Keyword LongName="servers"        ShortenName="Srv"/>
    <Keyword LongName="server"         ShortenName="Srv"/>
    <Keyword LongName="workstations"   ShortenName="Wks"/>
    <Keyword LongName="workstation"    ShortenName="Wks"/>
    <Keyword LongName="services"       ShortenName="Svc"/>
    <Keyword LongName="service"        ShortenName="Svc"/>
    <Keyword LongName="accounts"       ShortenName="Acct"/>
    <Keyword LongName="account"        ShortenName="Acct"/>
    <Keyword LongName="passwords"      ShortenName="Pwd"/>
    <Keyword LongName="password"       ShortenName="Pwd"/>
    <Keyword LongName="Firewalls"      ShortenName="Fwl"/>
    <Keyword LongName="Firewall"       ShortenName="Fwl"/>
    <Keyword LongName="security"       ShortenName="Secu"/>
    <Keyword LongName="local"          ShortenName="Loc"/>
    <Keyword LongName="administrators" ShortenName="Adm"/>
    <Keyword LongName="administrator"  ShortenName="Adm"/>
    <Keyword LongName="Operators"      ShortenName="Ope"/>
    <Keyword LongName="Operator"       ShortenName="Ope"/>
    <Keyword LongName="Managers"       ShortenName="Mgr"/>
    <Keyword LongName="Manager"        ShortenName="Mgr"/>
  </Translation>

  <GroupPolicies>
    <!-- ################################################################################################################################# -->
    <!-- The <WmiFilter> section allows the script to import MOF files to the Group Policy WMI Filters Container.                          -->
    <!-- Once a WMI Filter has been imported, it could be attached to a GPO through this script with te <GpoFilter> reference.             -->
    <!-- All MOF files to import must be located in .\Inputs\GroupPolicies\WmiFilters.                                                     -->
    <!-- Name refers to the display name, as shown in the GUI. Source refers to the source mof file to import.                             -->
    <!-- ################################################################################################################################# -->
    <WmiFilters>
      <Filter Name="Windows_X64_Only"                      Source="Windows_X64_Only.mof"                     />
      <Filter Name="Windows_X86_Only"                      Source="Windows_X86_Only.mof"                     />
      <Filter Name="Windows_Server_Only"                   Source="Windows_Server_Only.mof"                  />
      <Filter Name="Windows_Server_2016_And_Newer_Only"    Source="Windows_Server_2016_And_Newer_Only.mof"   />
      <Filter Name="Windows_Server_2012_R2_And_Older_Only" Source="Windows_Server_2012_R2_And_Older_Only.mof"/>
      <Filter Name="Windows_Client_Only"                   Source="Windows_Client_Only.mof"                  />
      <Filter Name="Windows_10_And_Newer_Only"             Source="Windows_10_And_Newer_Only.mof"            />
      <Filter Name="Windows_8.1_And_Older_Only"            Source="Windows_8.1_And_Older_Only.mof"           />
    </WmiFilters>

    <!-- ################################################################################################################################# -->
    <!-- The <GPO> elements list the Group Policy added (or refreshed) to the target domain.                                               -->
    <!-- Each of this Group Policy is first generated with no data (if not existing), then data is imported from its backup folder.        -->
    <!--   > BackupID...: refer to the unique ID of the backup folder                                                                      -->
    <!--   > validation.: if set to  No, the GPO is created and overwrited from its backup. Yes will only link the GPO to its targets.     -->
    <!--   > Name.......: refer to the display name, as shown in the GUI                                                                   -->
    <!--   > Description: description label, as shown in the GUI.                                                                          -->
    <!--                                                                                                                                   -->
    <!-- The <GPOMODE> will identify the Tier perimeter (for group management) and mode to be applied.                                     -->
    <!--   > Tier.......: Tier0, Tier1 or Tier2.                                                                                           -->
    <!--   > Mode.......: APPLY, DENY or BOTH. Apply create a group that limit the application scope, whereas DENY enforce the application -->
    <!--                  to everyone except the denied one. BOTH mix the two modes, enforcing application to only a scoped target group   -->
    <!--                  with an exception scope (usefull for migration or testing purpose). If mode is ommited, the mode BOTH will be    -->
    <!--                  used.                                                                                                            -->
    <!--                                                                                                                                   -->
    <!-- The <gpoDeny> ID attribute will set the specified identity with permission "Deny Execute" - you can se as many input as requiered.-->
    <!--   > ID......: use either sAMAccountName, object GUID or SID to identify the target identity to deny.                              -->
    <!--                                                                                                                                   -->
    <!-- The <gpoLink> attribute Will link the GPO to the specified target - you can use as many input as requiered.                       -->
    <!--   > Path....: DistinguishedName of the target OU where the GPO have to be linked. Use "RootDN" to refer to the DN of the domain.  -->
    <!--   > Enabled.: "Yes", "No". Teach the script to enable the link or not.                                                            -->
    <!--   > Enforced: "Yes", "No". Teach the script to enforce this stratagy to any descending GPO that normally overcome its parameters. -->
    <!--                                                                                                                                   -->
    <!-- The <GpoFilter> parameter refers to the WMI filter that should be linked to this GPO.                                             -->
    <!--   > WMI.....: the Display Name of the target WMI filter to be used (you can refer to the name section of the MOF import)          -->
    <!--                                                                                                                                   -->
    <!-- The <GpoSecurityFilter> parameter tasks the script to set "authenticated users" as read only and add a security group as new      -->
    <!-- security filter extension.                                                                                                        -->
    <!-- ################################################################################################################################# -->

    <!-- GPO GROUP SETTINGS: used to generate APPLY and DENY Group Name. Use %tier% to mark the Tier localization in the new name          -->
    <!--   > GpoName..: define the group name for applying or denying a group                                                              -->
    <GlobalGpoSettings GroupName="G-S-%tier%-GPO_%GpoName%_%mode%" Tier0="T0" Tier1="T1" Tier2="T2">
      <GpoTier0 OU="OU=GPO,OU=Groups Tier 0,OU=Administration,%rootDN%"/>
      <GpoTier1 OU="OU=GPO,OU=Groups Tier 1,OU=Administration,%rootDN%"/>
      <GpoTier2 OU="OU=GPO,OU=Groups Tier 2,OU=Administration,%rootDN%"/>
    </GlobalGpoSettings>

    <!-- TEMPLATE
	  <GPO BackupID="{9A9AD00F-56D9-476C-9D65-CEAD0FB31B4F}"  Validation="Yes" Name="display name" Description="gpo description">
		<GpoFilter>WmiFilterName</GpoFilter>
		<GpoLink Path="RootDN" Enabled="No" Enforced="No"/>
    </GPO>
	  -->
	  <GPO BackupID="{A76028A4-094B-4CD1-8A60-8DCC6E12F122}" Validation="Yes" Name="HAD-Login_Restrictions-T0-Servers" Description="GPO to manage who can open a session on a Tier 0 servers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Server_Only"/>
		  <GpoLink Path="OU=Harden - Tier 0,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{BDEAE713-340B-4ABD-ACDA-9660F55CAEDD}" Validation="Yes" Name="Security-Servers_Local-Administrators" Description="GPO to manage the groups members of local administrators group on workstations.">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Client_Only"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  </GroupPolicies>

  <Accounts>
    <!-- ################################################################################################################################### -->
    <!-- The <Account> Section list all user identities to be generated by the script.                                                       -->
    <!-- The script first check if the account is already present in the domain (if so, nothing is done), and if not, it will generatae it.  -->
    <!-- The newly created user is then stored with its random password in a keepass file (.\Outputs\HardenAD.kbdx).                         -->
    <!-- Each account is provided with the following input:                                                                                  -->
    <!--   > GivenName.....: the given name of the account                                                                                   -->
    <!--   > Surname.......: the surname of the account                                                                                      -->
    <!--   > sAMAccountName: the sAMAccountName of the account                                                                               -->
    <!--   > displayName...: the name displayed by the GUI                                                                                   -->
    <!--   > Description...: the description of the account                                                                                  -->
    <!--   > Path..........: the distingsuihedName of the OU containing the account. you can use ROOTDN to refer to the domain DN            -->
    <!-- ################################################################################################################################### -->
    <!-- Tier 0 accounts - Manager -->
    <User DisplayName="Loic VEIRMAN (T0M)" Surname="VEIRMAN" samAccountName="T0M-LVEIRMAN" GivenName="Loic" Description="Loic Veirman (Tier 0 Manager)" Path="OU=Users Tier 0,OU=Administration,ROOTDN"/>

    <!-- Tier 1 accounts - Managers -->
    <User DisplayName="Sylvain VEIRMAN (T1M)" Surname="VEIRMAN" samAccountName="T1M-SVEIRMAN" GivenName="Sylvain" Description="Sylvain Veirman (Tier 1 Manager)" Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>

    <!-- Tier 1 accounts - Administrators -->
    <User DisplayName="Jean-Paul VEIRMAN (T1A)" Surname="VEIRMAN" samAccountName="T1A-JPVEIRMAN" GivenName="Jean-Paul" Description="Jean-Paul Veirman (Tier 1 Administrator)" Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>

    <!-- Tier 1 accounts - Operators -->
    <User DisplayName="Loic VEIRMAN (T1O)"      Surname="VEIRMAN" samAccountName="T1O-LVEIRMAN"  GivenName="Loic"      Description="Loic Veirman (Tier 0 Operator)"      Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>
    <User DisplayName="Sylvain VEIRMAN (T1O)"   Surname="VEIRMAN" samAccountName="T1O-SVEIRMAN"  GivenName="Sylvain"   Description="Sylvain Veirman (Tier 1 Operator)"   Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>
    <User DisplayName="Jean-Paul VEIRMAN (T1O)" Surname="VEIRMAN" samAccountName="T1O-JPVEIRMAN" GivenName="Jean-Paul" Description="Jean-Paul Veirman (Tier 1 Operator)" Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>

    <!-- Tier 2 accounts - Managers -->
    <User DisplayName="Yolande VEIRMAN (T2M)" Surname="VEIRMAN" samAccountName="T2M-YVEIRMAN" GivenName="Yolande" Description="Yolande Veirman (Tier 2 Manager)" Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>

    <!-- Tier 2 accounts - Administrators -->
	<User DisplayName="Chantal VEIRMAN (T2A)" Surname="VEIRMAN" samAccountName="T2A-CVEIRMAN" GivenName="Chantal" Description="Chantal Veirman (Tier 2 Adminstrator)" Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>
    
	<!-- Tier 2 accounts - Operators -->
    <User DisplayName="Loic VEIRMAN (T2O)"    Surname="VEIRMAN" samAccountName="T2O-LVEIRMAN" GivenName="Loic"    Description="Loic Veirman (Tier 2 Operator)"    Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>
    <User DisplayName="Yolande VEIRMAN (T2O)" Surname="VEIRMAN" samAccountName="T2O-YVEIRMAN" GivenName="Yolande" Description="Yolande Veirman (Tier 2 Operator)" Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>
	<User DisplayName="Chantal VEIRMAN (T2O)" Surname="VEIRMAN" samAccountName="T2O-CVEIRMAN" GivenName="Chantal" Description="Chantal Veirman (Tier 2 Operator)" Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>

	<!-- Tier Legacy accounts - Operators -->
    <User DisplayName="Loic VEIRMAN (TLO)"      Surname="VEIRMAN" samAccountName="TLO-LVEIRMAN"  GivenName="Loic"      Description="Loic Veirman (Tier Legacy Operator)"      Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <User DisplayName="Sylvain VEIRMAN (TLO)"   Surname="VEIRMAN" samAccountName="TLO-SVEIRMAN"  GivenName="Sylvain"   Description="Sylvain Veirman (Tier Legacy Operator)"   Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <User DisplayName="Jean-Paul VEIRMAN (TLO)" Surname="VEIRMAN" samAccountName="TLO-JPVEIRMAN" GivenName="Jean-Paul" Description="Jean-Paul Veirman (Tier Legacy Operator)" Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <User DisplayName="Yolande VEIRMAN (TLO)"   Surname="VEIRMAN" samAccountName="TLO-YVEIRMAN"  GivenName="Yolande"   Description="Yolande Veirman (Tier Legacy Operator)"   Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
	<User DisplayName="Chantal VEIRMAN (TLO)"   Surname="VEIRMAN" samAccountName="TLO-CVEIRMAN"  GivenName="Chantal"   Description="Chantal Veirman (Tier Legacy Operator)"   Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
  </Accounts>

  <Groups>
    <!-- ################################################################################################################################### -->
    <!-- The <Groups> Section list all group identities to be generated by the script.                                                       -->
    <!-- The script first check if the group is already present in the domain (if so, nothing is done), and if not, it will generatae it.    -->
    <!-- Each group is provided with the following input:                                                                                    -->
    <!--   > Name..........: the name of the group, also its display name and sAMAccountName                                                 -->
    <!--   > Description...: the description of the group                                                                                    -->
    <!--   > Scope.........: domainLocal, Local, Global or Universal                                                                         -->
    <!--   > Category......: security or distribution                                                                                        -->
    <!--                                                                                                                                     -->
    <!-- In a second time, all groups are populated with the <member> input.                                                                 -->
    <!--   > sAMAccountName: the sAMAccountName of the target member.                                                                        -->
    <!-- ################################################################################################################################### -->
    <!-- #### TIER 0 #### -->
    <Group name="G-S-T0_Managers" Category="Security" Scope="Global" Description="Members of this group can see and manage all the Active Directory objects" Path="OU=Groups Tier 0,OU=Administration,ROOTDN">
      <Member samAccountName="T0M-LVEIRMAN"/>
    </Group>

    <Group name="L-S-T0_LocalAdmins_Servers" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier 0,OU=Administration,ROOTDN">
    </Group>

    <!-- #### TIER 1 #### -->
	<Group name="G-S-T1_Managers" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 1 ressources, including T1 admin users and groups" Path="OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="T1M-SVEIRMAN"/>
    </Group>

    <Group name="G-S-T1_Administrators" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 1 ressources, excluding T1 admin users and groups" Path="OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="T1A-JPVEIRMAN"/>
    </Group>

    <Group name="G-S-T1_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier 1 resources (login)" Path="OU=Groups Tier 1,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T1-DELEG_Group - Manage Membership" Category="Security" Scope="domainLocal" Description="Members of this group can add and remove members of tier 1 groups within productions OUs" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="T1O-LVEIRMAN"/>
      <Member samAccountName="T1O-SVEIRMAN"/>
      <Member samAccountName="T1O-JPVEIRMAN"/>
    </Group>

    <Group name="L-S-T1-DELEG_Group - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>
 
	<Group name="L-S-T1-DELEG_Group - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within Tier 1 Administration OU" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_User - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_User - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within Tier 1 administration OU" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_Computer - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete commputers within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_Contact - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete contact within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T1_LocalAdmins_Servers" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier 1,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T1-DELEG_LAPS_PwdRead" Category="Security" Scope="domainLocal" Description="Members of this group will be able to read LAPS password for workstations" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Operators"/>
    </Group>

    <Group name="L-S-T1-DELEG_LAPS_PwdReset" Category="Security" Scope="domainLocal" Description="Members of this group will be able to reset LAPS password for workstations" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
    </Group>

    <!-- #### TIER 2 #### -->
    <Group name="G-S-T2_Managers" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 2 ressources, including T1 admin users and groups" Path="OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="T2M-YVEIRMAN"/>
    </Group>

    <Group name="G-S-T2_Administrators" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 2 ressources, excluding T1 admin users and groups" Path="OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="T2A-CVEIRMAN"/>
    </Group>

    <Group name="G-S-T2_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier 2 resources (login)" Path="OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="T2O-LVEIRMAN"/>
      <Member samAccountName="T2O-CVEIRMAN"/>
      <Member samAccountName="T2O-YVEIRMAN"/>
    </Group>

    <Group name="L-S-T2-DELEG_Group - Manage Membership" Category="Security" Scope="domainLocal" Description="Members of this group can add and remove members of tier 1 groups within productions OUs" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_Group - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T2-DELEG_Group - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within Tier 1 Administration OU" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_User - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_User - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within Tier 1 administration OU" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_Computer - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete commputers within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_Contact - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete contact within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2_LocalAdmins_Workstations" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier 2,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T2-DELEG_LAPS_PwdRead" Category="Security" Scope="domainLocal" Description="Members of this group will be able to read LAPS password for workstations" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Operators"/>
    </Group>

    <Group name="L-S-T2-DELEG_LAPS_PwdReset" Category="Security" Scope="domainLocal" Description="Members of this group will be able to reset LAPS password for workstations" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
    </Group>

    <!-- #### TIER LEGACY #### -->
    <Group name="G-S-TL_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier Legacy resources (login)" Path="OU=Groups Tier Legacy,OU=Administration,ROOTDN">
      <Member samAccountName="TLO-LVEIRMAN"/>
      <Member samAccountName="TLO-CVEIRMAN"/>
      <Member samAccountName="TLO-YVEIRMAN"/>
      <Member samAccountName="TLO-SVEIRMAN"/>
      <Member samAccountName="TLO-JPVEIRMAN"/>
    </Group>

    <Group name="L-S-TL_LocalAdmins_Servers" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier Legacy,OU=Administration,ROOTDN">
    </Group>
    <Group name="L-S-TL_LocalAdmins_Workstations" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier Legacy,OU=Administration,ROOTDN">
    </Group>  
  </Groups>
  
  <DefaultMembers>
    <!-- ################################################################################################################################### -->
    <!-- The <DefaultMembers> Section list strictely allowed members of a specified group.                                                   -->
    <!-- When the script call the function "Reset-GroupMembership", the function will use this data to leave only mandatory identity.        -->
    <!--   > Member: either a SID or a sAMAccountName. Use %domainSID% to dynamically replace it by the domain SID.                          -->
    <!-- ################################################################################################################################### -->
    <!-- Builtin\Administrators -->
    <Group Target="S-1-5-32-544">
      <Member>%DomainSID%-500</Member>
      <Member>%DomainSID%-512</Member>
      <Member>%DomainSID%-519</Member>
    </Group>
    <!-- Domain Admins -->
    <Group Target="%DomainSID%-512">
      <Member>%DomainSID%-500</Member>
    </Group>
    <!-- Enterprise Admins -->
    <Group Target="%DomainSID%-519">
      <Member>%t0-Managers%</Member>
    </Group>
    <!-- Protected Users -->
    <Group Target="%DomainSID%-525">
      <Member>%t0-managers%</Member>
    </Group>
  </DefaultMembers>
  
  <TaskSchedules BaseDir="C:\_ADM\TasksSchedulesScripts">
    <!-- ################################################################################################################################### -->
    <!-- the <TaskSchedules> section define the sched. tasks to add to the running system and is called by the function New-ScheduleTasks.   -->
    <!-- The following parameters are expected:                                                                                              -->
    <!--   > Name......: The scheduled tasks name, as shown in the GUI.                                                                      -->
    <!--   > Xml.......: The xml file containing a backup of the new scheduled tasks and located in .\Inputs\ScheduleTasks\TasksSchedulesXml -->
    <!--   > SchedCmd..: The executable to be used. It will replace the %command% in the xml file.                                           -->
    <!--   > SchedArg..: The arguments line to pass to the executable. If a script is specified, it should present in                        -->
    <!--                 .\Inputs\ScheduleTasks\TasksSchedulesScripts                                                                        -->
    <!--   > SchedDir..: The effective path context when the schedule is run - use %BaseDir% to refer to the directory value speciefied in   -->
    <!--                 the "BaseDir" parameters of the section <TaskSchedules> (this one, yup).                                            -->
    <!--   > SchedDsc..: The description field for this task.                                                                                -->
    <!--   > SchedPth..: The folder name where the task will be stored in the Tasks Scheduler console.                                       -->
    <!-- ################################################################################################################################### -->
    <!-- flushing Sensible groups with MCS-GroupsFlushing.ps1 -->
    <SchedTask Name="MCS - Sensitive Groups Flushing" Xml="MCS-GroupsFlushing.xml">
      <SchedCmd>powershell.exe</SchedCmd>
      <SchedArg>-windowstyle hidden -file .\MCS-GroupsFlushing.ps1</SchedArg>
      <SchedDir>%BaseDir%\MCS-GroupsFlushing</SchedDir>
      <SchedDsc>Flush highly sensitive groups (see MCS-GroupsScheduling.csv for details)</SchedDsc>
      <SchedPth>HardenAD</SchedPth>
    </SchedTask>
  </TaskSchedules>

  <LocalAdminPasswordSolution>
    <!-- ################################################################################################################################### -->
    <!-- The <LocalAdminPasswordSolution> is used to setup LAPS over an existing domain. 													 -->
	  <!-- By default, the model delegate permission to Tier 1 for servers and Tier 2 for workstations. All others are handled by Dom admins.  -->
    <!--                                                                                                                                     -->
    <!-- SelfPermission: Add Write Permission to ms-Mcs-AdmPwdExiprationTime and ms-Mcs-AdmPwd attribute to SELF (i.e. the computer object). -->
	  <!-- PasswordReader: Offer the ability to read ms-Mcs-AdmPwd which contains the local user password                                      -->
	  <!-- PasswordReset.: Offer the ability to read and write ms-Mcs-AdmPwdExiprationTime and ms-Mcs-AdmPwd attribute						 -->
	  <!--                                                                                                                                     -->
	  <!-- The script now handles dynamic group mapping and will look at the <Translation> section of this document.							 -->
	  <!--                                                                                                                                     -->	
	  <!-- <AdmPwdSelfPermission>:                                                                                                             -->
    <!--    Target: target OU distinguished name with computer objects. use "RootDN" to dynamically specify the domain distanguished name.   -->
    <!--                                                                                                                                     -->
    <!-- <AdmPwdPasswordreader>:                                                                                                             -->
    <!--    Target: target OU distinguished name with computer objects. use "RootDN" to dynamically specify the domain distanguished name.   -->
    <!--    Id....: Specific the group sAMAccountName to be granted with the password read permission on the target OU.                      -->
    <!--                                                                                                                                     -->
    <!-- <AdmPwdPasswordreset>:                                                                                                              -->
    <!--    Target: target OU distinguished name with computer objects. use "RootDN" to dynamically specify the domain distanguished name.   -->
    <!--    Id....: Specific the group sAMAccountName to be granted with the password reset permission on the target OU.                     -->
    <!-- ################################################################################################################################### -->
    <AdmPwdSelfPermission Target="OU=Servers,OU=Harden - Tier Legacy,%RootDN%"/>
    <AdmPwdSelfPermission Target="OU=Servers,OU=Harden - Tier 1 and 2,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=Workstations,OU=Harden - Tier Legacy,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=Workstations,OU=Harden - Tier 1 and 2,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=PAW Tier 0,OU=Administration,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=PAW Tier 1,OU=Administration,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=PAW Tier 2,OU=Administration,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=PAW Tier Legacy,OU=Administration,%RootDN%"/>
	
	  <AdmPwdPasswordReader Target="OU=Servers,OU=Harden - Tier Legacy,%RootDN%"       Id="%domain%\%T1-LAPS-PasswordReader%"/>
    <AdmPwdPasswordReader Target="OU=Servers,OU=Harden - Tier 1 and 2,%RootDN%"      Id="%domain%\%T1-LAPS-PasswordReader%"/>
    <AdmPwdPasswordReader Target="OU=Workstations,OU=Harden - Tier Legacy,%RootDN%"  Id="%domain%\%T2-LAPS-PasswordReader%"/>
    <AdmPwdPasswordReader Target="OU=Workstations,OU=Harden - Tier 1 and 2,%RootDN%" Id="%domain%\%T2-LAPS-PasswordReader%"/>
    
	  <AdmPwdPasswordReset  Target="OU=Servers,OU=Harden - Tier Legacy,%RootDN%"       Id="%domain%\%T1-LAPS-PasswordReset%"/>
    <AdmPwdPasswordReset  Target="OU=Servers,OU=Harden - Tier 1 and 2,%RootDN%"      Id="%domain%\%T1-LAPS-PasswordReset%"/>
    <AdmPwdPasswordReset  Target="OU=Workstations,OU=Harden - Tier Legacy,%RootDN%"  Id="%domain%\%T2-LAPS-PasswordReset%"/>
    <AdmPwdPasswordReset  Target="OU=Workstations,OU=Harden - Tier 1 and 2,%RootDN%" Id="%domain%\%T2-LAPS-PasswordReset%"/>	
  </LocalAdminPasswordSolution>

  <Sequence>
    <!-- ################################################################################################################################### -->
    <!-- the <Sequence> section define the different tasks to iterate in "sequence" (can't resist to this one).                              -->
    <!-- To deal with highlight color in display, use the ` to initiate and end a color change in your string, then use one of the three     -->
    <!-- characters specified in value AltBaseHTxt(A,B, or C) to select your color: the color will switch back to normal at the next `.      -->
    <!--			                                                                                                                         -->
    <!-- The default highlight values are those one:                                                                                         -->
    <!--   > `[my text` : magenta                                                                                                            -->
    <!--   > `(my text` : yellow                                                                                                             -->
    <!--   > `{my text` : gray                                                                                                               -->
    <!--			                                                                                                                         -->
    <!-- Some special inputs are usefull to replace value dynamically :                                                                   	 -->
    <!--	 > FileName   : replace with the value of this file                                                                              -->
    <!--	 > RootDN     : replace with domain root DN                                                                                      -->
    <!--			                                                                                                                         -->
    <!-- Each task ID is executed in sequence, based on the Number vaue (ascending). Each Task ID use the following attributes:              -->
    <!--   > Number         : Define the squence order, the lowest will be run first.                                                        -->
    <!--   > Name           : ID task name as refered in the final log output.                                                               -->
    <!--   > CallingFunction: Name of the function to be called from one of the .psm1 files present in the modules directory.                -->
    <!--   > UseParameters  : Mandatory (but could be empty). Specify parameter to pass as argument to CallingFunction.                      -->
    <!--                      Use on per parameter and sort them in sequence (your script should refer them using input ordering).           -->
    <!--   > TaskEnabled    : YES or NO. When set to NO, the tasks is disabled and will not be applied.                                      -->
    <!-- ################################################################################################################################### -->

    <!-- SET MS-DS-MACHINEACCOUNTQUOTA TO 0                                                                                                  -->
    <Id Number="010" Name="Restrict computer junction to the domain">
      <CallingFunction>Set-msDSMachineAccountQuota</CallingFunction>
      <!--Parameter: new ms-DS-MachineAccountQuota value                                                                                     -->
      <UseParameters>0</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(msDSMachineAccountQuota` to `(0` to restrict domain junction</TaskDescription>
    </Id>

    <!-- ENABLE THE AD RECYCLE BIN                                                                                                           -->
    <Id Number="020" Name="Activate Active Directory Recycle Bin">
      <CallingFunction>Set-ADRecycleBin</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>activate the `(AD Recycle Bin` optional feature</TaskDescription>
    </Id>

    <!-- CONFIGURE ALL AD SITE LINKS WITH THE NOTIFY OPTIONS                                                                                 -->
    <Id Number="030" Name="Set Notify on every Site Links">
      <CallingFunction>Set-SiteLinkNotify</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(notify` on every `(Site Links</TaskDescription>
    </Id>

    <!-- ACTIVATE THE GPO CENTRAL STORE                                                                                                      -->
    <Id Number="040" Name="Set GPO Central Store">
      <CallingFunction>Set-GpoCentralStore</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(GPO Central Store` and update `{adm` and `{admx` files</TaskDescription>
    </Id>

    <!-- GENERATE NEW ADMINISTRATION ORGANIZATIONAL UNIT                                                                                     -->
    <Id Number="050" Name="Set Administration Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_ADMIN</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Administration` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW TIER 0 ORGANIZATIONAL UNIT                                                                                     -->
    <Id Number="051" Name="Set Tier 0 Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_PROD-T0</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Tier 0` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW TIER 1 and 2 ORGANIZATIONAL UNIT                                                                                     -->
    <Id Number="052" Name="Set Tier 1 and Tier 2 Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_PROD-T1and2</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Tier 1 and Tier 2 combo` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW LEGACY ORGANIZATIONAL UNIT                                                                                     -->
    <Id Number="053" Name="Set Legacy Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_PROD-LEGACY</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Tier Legacy` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW DEFAULT OBJECTS LOCATION TREE                                                                                          -->
    <Id Number="060" Name="Set Provisionning Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>PROVISIONNING-EN</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Provisionning` organizational unit</TaskDescription>
    </Id>

    <!-- RELOCATE NEW USER/GROUP OBJECT LOCATION                                                                                             -->
    <Id Number="070" Name="Default user location on creation">
      <CallingFunction>Set-DefaultObjectLocation</CallingFunction>
      <!--Parameter: user or computer                                                                                                        -->
      <UseParameters>User</UseParameters>
      <!--Parameter: OU distinguishedName. Use RootDN to automatically fill-in the domain name                                               -->
      <UseParameters>OU=users,OU=provisionning,RootDN</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(user objects` default location</TaskDescription>
    </Id>

    <!-- RELOCATE NEW COMPUTER OBJECT LOCATION                                                                                             -->
    <Id Number="071" Name="Default computer location on creation">
      <CallingFunction>Set-DefaultObjectLocation</CallingFunction>
      <!--Parameter: user or computer                                                                                                      -->
      <UseParameters>Computer</UseParameters>
      <!--Parameter: OU distinguishedName. Use RootDN to automatically fill-in the domain name                                             -->
      <UseParameters>OU=computers,OU=provisionning,RootDN</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(computer objects` default location</TaskDescription>
    </Id>

    <!-- GENERATE NEW ADMIN ACCOUNTS ON WHICH THE DELEGATION MODEL WILL WORKS                                                              -->
    <Id Number="080" Name="Create administration accounts">
      <CallingFunction>New-AdministrationAccounts</CallingFunction>
      <!-- Parameter: KeePass password for the kdbx database                                                                               -->
      <UseParameters>H4rd3n@D!!</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>create `(administration accounts` used by the tier model</TaskDescription>
    </Id>

    <!-- GENERATE NEW ADMIN GROUPS ON WHICH THE DELEGATION MODEL WILL WORKS                                                                -->
    <Id Number="090" Name="Create administration groups">
      <CallingFunction>New-AdministrationGroups</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>create `(administration groups` used by the tier model</TaskDescription>
    </Id>

    <!-- ACEs DEPLOYMENT FOR DELEGATION MODEL                                                                                               -->
    <Id Number="095" Name="Enforce delegation model through ACEs">
      <CallingFunction>Push-DelegationModel</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Enforce `(Delegation ACEs` used by the tier model</TaskDescription>
    </Id>

    <!-- IMPORT WMI FILTERS                                                                                                                -->
    <Id Number="125" Name="Import additional WMI Filters">
      <CallingFunction>Import-WmiFilters</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Import `(WMI filter` to the domain</TaskDescription>
    </Id>

    <!-- IMPORT GPOs                                                                                                                       -->
    <Id Number="130" Name="Import new GPO or update existing ones">
      <CallingFunction>New-GpoObject</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Import or update `(group policy objects` to the domain and link them</TaskDescription>
    </Id>

    <!-- LAPS SCHEMA UPDATE AND POWERSHELL TOOLING DEPLOYMENT                                                                              -->
    <!-- Warning: this only works with .Net 4.0 or greater.                                                                                -->
    <Id Number="134" Name="Update Ad schema for LAPS and deploy PShell tools">
      <CallingFunction>Install-Laps</CallingFunction>
      <!-- Parameter: ForceDcIsSchemaOwner (default) will require that the running system is also the Schema Master owner                  -->
      <!--            IgnoreDcIsSchameOwner will remove this requierment (child domain, etc.)                                              -->
      <UseParameters>ForceDcIsSchemaOwner</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Update `(AD Schema` for `[LAPS` and add `(PShell add-on`</TaskDescription>
    </Id>

    <!-- LAPS PERMISSIONS DEPLOYMENT OVER THE DOMAIN                                                                                       -->
    <Id Number="135" Name="Setup LAPS permissions over the domain">
      <CallingFunction>Set-LapsPermissions</CallingFunction>
      <!-- Parameter: CUSTOM : will teach the script to apply a fine-grained definition (refering to <LocalAdminPasswordSolution>)         -->
      <!--            DEFAULT: will apply permission at the root domain level and leave domain admins as the only allowed users.           -->
      <UseParameters>CUSTOM</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Set-up `(LAPS` permissions on the target domain</TaskDescription>
    </Id>

    <!-- LAPS DEPLOYMENT SCRIPT UDATE                                                                                                      -->
    <Id Number="136" Name="Update LAPS deployment scripts">
      <CallingFunction>Set-LapsScripts</CallingFunction>
      <!-- Parameter: use NETLOGON or SYSVOL for a dynamic location. Else enter the UNC Path                                               -->
      <UseParameters>NETLOGON\LAPS</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Update `(LAPS Scripts` to match with the domain name</TaskDescription>
    </Id>

    <!-- IMPORT SCHEDULE TASKS                                                                                                             -->
    <Id Number="140" Name="Import schedule tasks on the running system">
      <CallingFunction>New-ScheduleTasks</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Import new `(schedule tasks` to the `[running system`</TaskDescription>
    </Id>

    <!-- RESET SENSIBLE GROUPS                                                                                                             -->
    <Id Number="150" Name="Reset Group Memberships">
      <CallingFunction>Reset-GroupMembership</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Reset `(groups's membeberships` to the `[trusted list`</TaskDescription>
    </Id>
  </Sequence>
</Settings>

