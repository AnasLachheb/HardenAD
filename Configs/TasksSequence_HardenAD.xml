<?xml version="1.0" encoding="utf-8"?>
<Settings>
  <!-- ################################################################################################################################### -->
  <!-- Revision: 2022/07/08 - contact@hardenad.net                                                                                         -->
  <!-- ################################################################################################################################### -->
  <OrganizationalUnits>
    <!-- The section <ouTree> handle the base model for OU creation.                                                                       -->
    <!-- When calling the function [Set-OUTree], you need to add as parameter the "OU class" name of the tree structure you want to add.   -->
    <!-- This could also be used to manage new OU generation.                                                                              -->
    <ouTree>
      <!-- CLASS: HardenAD_ADMIN                                                                                                           -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_ADMIN" Name="Administration" Description="Privileged accounts administrative OU">
        <ChildOU>
			<Name>PAW Tier 0</Name>
			<Description>Privilege Admin Worstations Tier 0</Description>
		</ChildOU>
       <ChildOU>
			<Name>PAW Tier 1</Name>
			<Description>Privilege Admin Worstations Tier 1</Description>
		</ChildOU>
        <ChildOU>
			<Name>PAW Tier 2</Name>
			<Description>Privilege Admin Worstations Tier 2</Description>
		</ChildOU>
        <ChildOU>
			<Name>PAW Tier Legacy</Name>
			<Description>Privilege Admin Worstations Tier Legacy</Description>
		</ChildOU>
		<ChildOU>
          <Name>Groups Tier 0</Name>
          <Description>Groups to manage Tier 0 objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>Local Admins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users Tier 0</Name>
          <Description>Users to manage Tier 0 objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups Tier 1</Name>
          <Description>Groups to manage Tier 1 objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>Local Admins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users Tier 1</Name>
          <Description>Users to manage Tier 1 objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups Tier 2</Name>
          <Description>Groups to manage Tier 2 objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>Local Admins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users Tier 2</Name>
          <Description>Groups to manage Tier 2 objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups Tier Legacy</Name>
          <Description>Groups to manage Legacy objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>Local Admins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users Tier Legacy</Name>
          <Description>Users to manage Legacy objects</Description>
        </ChildOU>
      </OU>

      <!-- CLASS: HardenAD_PROD-T0                                                                                                         -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_PROD-T0" Name="Harden - Tier 0" Description="Tier 0 resources">
        <ChildOU>
          <Name>Contacts</Name>
          <Description>Contacts objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups</Name>
          <Description>Groups objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Servers</Name>
          <Description>Computer objects belonging to this Tier and acting as servers</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Services</Name>
          <Description>Service accounts belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Service accounts synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled sevice accounts</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users</Name>
          <Description>User objects belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>User objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled user objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Workstations</Name>
          <Description>Computer Objects belonging to this Tier and acting as clients</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>

      </OU>

      <!-- CLASS: HardenAD_PROD-T1and2                                                                                                     -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_PROD-T1and2" Name="Harden - Tier 1 and 2" Description="Tier 1 and Tier 2 resources">
        <ChildOU>
          <Name>Contacts</Name>
          <Description>Contacts objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups</Name>
          <Description>Groups objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Servers</Name>
          <Description>Computer objects belonging to this Tier and acting as servers</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Services</Name>
          <Description>Service accounts belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Service accounts synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled sevice accounts</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users</Name>
          <Description>User objects belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>User objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled user objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Workstations</Name>
          <Description>Computer Objects belonging to this Tier and acting as clients</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>

      </OU>

      <!-- CLASS: HardenAD_PROD-LEGACY                                                                                                     -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_PROD-LEGACY" Name="Harden - Tier Legacy" Description="Legacy resources">
        <ChildOU>
          <Name>Contacts</Name>
          <Description>Contacts objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups</Name>
          <Description>Groups objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Servers</Name>
          <Description>Computer objects belonging to this Tier and acting as servers</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Services</Name>
          <Description>Service accounts belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Service accounts synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled sevice accounts</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users</Name>
          <Description>User objects belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>User objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled user objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Workstations</Name>
          <Description>Computer Objects belonging to this Tier and acting as clients</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>

      </OU>

      <!-- CLASS: PROVISIONNING-EN                                                                                                         -->
      <!-- This class generate an OU tree used for provisionning objects in a default location. This is the English Edition.               -->
      <OU Class="PROVISIONNING-EN" Name="Provisionning" Description="New objects provisionning OU">
        <ChildOU>
          <Name>Users</Name>
          <Description>New user objects</Description>
        </ChildOU>

        <ChildOU>
          <Name>Computers</Name>
          <Description>New computer objects</Description>
        </ChildOU>
      </OU>
    </ouTree>
  </OrganizationalUnits>

  <!-- ################################################################################################################################# -->
  <!-- NEW SECTION (2022/07)                                                                                                             -->
  <!-- This section push delegation ACL to designated OU                                                                                 -->
  <!-- ################################################################################################################################# -->
  <DelegationACEs>
    <!-- Administration -->
    <!-- Delegation for L-S-T1-DELEG_Group - Create and Delete (administration) -->
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups Tier 1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType=""      TargetDN="OU=Groups Tier 1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups Tier Legacy,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType=""      TargetDN="OU=Groups Tier Legacy,OU=Administration,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_Group - Create and Delete (administration) -->
    <ACL Trustee="L-S-T2-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups Tier 2,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Group - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType=""      TargetDN="OU=Groups Tier 2,OU=Administration,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_User - Create and Delete (administration) -->
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="user"  TargetDN="OU=Users Tier 1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user"  ObjectType=""      TargetDN="OU=Users Tier 1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="user"  TargetDN="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user"  ObjectType=""      TargetDN="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_User - Create and Delete (administration) -->
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="user"  TargetDN="OU=Users Tier 2,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete (administration)" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user"  ObjectType=""      TargetDN="OU=Users Tier 2,OU=Administration,ROOTDN"/>
    <!-- Production -->
    <!-- Delegation for L-S-T1-DELEG_Computer - Create and Delete -->
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""         ObjectType="computer" TargetDN="OU=Servers,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType=""         TargetDN="OU=Servers,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""         ObjectType="computer" TargetDN="OU=Servers,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType=""         TargetDN="OU=Servers,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_User - Create and Delete -->
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""     ObjectType="user" TargetDN="OU=Services,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType=""     TargetDN="OU=Services,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""     ObjectType="user" TargetDN="OU=Services,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType=""     TargetDN="OU=Services,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_Computer - Create and Delete -->
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""         ObjectType="computer" TargetDN="OU=Workstations,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType=""         TargetDN="OU=Workstations,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""         ObjectType="computer" TargetDN="OU=Workstations,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType=""         TargetDN="OU=Workstations,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_Group - Create and Delete -->
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType=""      TargetDN="OU=Groups,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""      ObjectType="group" TargetDN="OU=Groups,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType=""      TargetDN="OU=Groups,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_contact - Create and Delete -->
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""        ObjectType="contact" TargetDN="OU=contacts,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="contact" ObjectType=""        TargetDN="OU=Contacts,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""        ObjectType="contact" TargetDN="OU=Contacts,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="contact" ObjectType=""        TargetDN="OU=Contacts,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_User - Create and Delete -->
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""     ObjectType="user" TargetDN="OU=Users,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType=""     TargetDN="OU=Users,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All"         InheritedObjects=""     ObjectType="user" TargetDN="OU=Users,OU=Harden - Tier Legacy,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="GenericAll"               RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType=""     TargetDN="OU=Users,OU=Harden - Tier Legacy,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_Group - Manage Membership -->
    <ACL Trustee="L-S-T2-DELEG_Group - Manage Membership" Right="ReadProperty, WriteProperty" RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType="" TargetDN="OU=Groups,OU=Harden - Tier 1 and 2,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Group - Manage Membership" Right="ReadProperty, WriteProperty" RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType="" TargetDN="OU=Groups,OU=Harden - Tier Legacy,ROOTDN"/>
  </DelegationACEs>

  <!-- ################################################################################################################################# -->
  <!-- NEW SECTION (2022/07)                                                                                                             -->
  <!-- This section create a reference table to be used through the scripts                                                              -->
  <!-- For now, only the GPO parts use this dynamic logic to fillup the migration and the preference table.                              -->
  <!--    > WellKnownID..: used to replace a dynamic pattern in a name (group, user, path, gpo, ...)                                     -->
  <!--    > Keyword......: used to shorten a word in a name (group, user, path, gpo, ...), helping in avoiding too long name in AD       -->
  <!-- ################################################################################################################################# -->
  <Translation>
    <wellKnownID objectClass="text"  translateFrom="%AuthenticatedUsers%"         translateTo="Authenticated Users"/>
    <wellKnownID objectClass="text"  translateFrom="%Administrators%"             translateTo="Administrators"/>
	  <wellKnownID objectClass="text"  translateFrom="%domain%"                     translateTo="FORMATION99"/>
    <wellKnownID objectClass="text"  translateFrom="%domaindns%"                  translateTo="formation99.lan"/>
    <wellKnownID objectClass="text"  translateFrom="%RemoteDesktopUsers%"         translateTo="Remote Desktop Users"/>
    <wellKnownID objectClass="text"  translateFrom="%RootDN%"					            translateTo="DC=formation99,DC=lan"/>
    <wellKnownID objectClass="text"  translateFrom="%Users%"					            translateTo="Users"/>
    <wellKnownID objectClass="group" translateFrom="%t0-managers%"                translateTo="G-S-T0_Managers"/>
    <wellKnownID objectClass="group" translateFrom="%t0-localAdmin-servers%"      translateTo="L-S-T0_LocalAdmins_Servers"/>
    <wellKnownID objectClass="group" translateFrom="%t0-localAdmin-workstations%" translateTo="L-S-T0_LocalAdmins_Workstations"/>
    <wellKnownID objectClass="group" translateFrom="%t1-managers%"                translateTo="G-S-T1_Managers"/>
    <wellKnownID objectClass="group" translateFrom="%t1-administrators%"          translateTo="G-S-T1_Administrators"/>
    <wellKnownID objectClass="group" translateFrom="%t1-operators%"               translateTo="G-S-T1_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%t1-localAdmin-servers%"      translateTo="L-S-T1_LocalAdmins_Servers"/>
    <wellKnownID objectClass="group" translateFrom="%t2-managers%"                translateTo="G-S-T2_Managers"/>
    <wellKnownID objectClass="group" translateFrom="%t2-administrators%"          translateTo="G-S-T2_Administrators"/>
    <wellKnownID objectClass="group" translateFrom="%t2-operators%"               translateTo="G-S-T2_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%t2-localAdmin-workstations%" translateTo="L-S-T2_LocalAdmins_Workstations"/>
    <wellKnownID objectClass="group" translateFrom="%tl-operators%"               translateTo="G-S-TL_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%tl-localAdmin-servers%"      translateTo="L-S-TL_LocalAdmins_Servers"/>
    <wellKnownID objectClass="group" translateFrom="%tl-localAdmin-workstations%" translateTo="L-S-TL_LocalAdmins_Workstations"/>
	  <wellKnownID objectClass="group" translateFrom="%T1-LAPS-PasswordReset%"	    translateTo="L-S-T1-DELEG_LAPS_PwdReset"/>
	  <wellKnownID objectClass="group" translateFrom="%T1-LAPS-PasswordReader%"	    translateTo="L-S-T1-DELEG_LAPS_PwdRead"/>
	  <wellKnownID objectClass="group" translateFrom="%T2-LAPS-PasswordReset%"	    translateTo="L-S-T2-DELEG_LAPS_PwdReset"/>
	  <wellKnownID objectClass="group" translateFrom="%T2-LAPS-PasswordReader%"	    translateTo="L-S-T2-DELEG_LAPS_PwdRead"/>
    
    <Keyword LongName="servers"        ShortenName="Srv"/>
    <Keyword LongName="server"         ShortenName="Srv"/>
    <Keyword LongName="workstations"   ShortenName="Wks"/>
    <Keyword LongName="workstation"    ShortenName="Wks"/>
    <Keyword LongName="services"       ShortenName="Svc"/>
    <Keyword LongName="service"        ShortenName="Svc"/>
    <Keyword LongName="accounts"       ShortenName="Acct"/>
    <Keyword LongName="account"        ShortenName="Acct"/>
    <Keyword LongName="passwords"      ShortenName="Pwd"/>
    <Keyword LongName="password"       ShortenName="Pwd"/>
    <Keyword LongName="Firewalls"      ShortenName="Fwl"/>
    <Keyword LongName="Firewall"       ShortenName="Fwl"/>
    <Keyword LongName="security"       ShortenName="Secu"/>
    <Keyword LongName="local"          ShortenName="Loc"/>
    <Keyword LongName="administrators" ShortenName="Adm"/>
    <Keyword LongName="administrator"  ShortenName="Adm"/>
    <Keyword LongName="Operators"      ShortenName="Ope"/>
    <Keyword LongName="Operator"       ShortenName="Ope"/>
    <Keyword LongName="Managers"       ShortenName="Mgr"/>
    <Keyword LongName="Manager"        ShortenName="Mgr"/>
  </Translation>

  <GroupPolicies>
    <!-- ################################################################################################################################# -->
    <!-- The <WmiFilter> section allows the script to import MOF files to the Group Policy WMI Filters Container.                          -->
    <!-- Once a WMI Filter has been imported, it could be attached to a GPO through this script with te <GpoFilter> reference.             -->
    <!-- All MOF files to import must be located in .\Inputs\GroupPolicies\WmiFilters.                                                     -->
    <!-- Name refers to the display name, as shown in the GUI. Source refers to the source mof file to import.                             -->
    <!-- ################################################################################################################################# -->
    <WmiFilters>
      <Filter Name="Windows_X64_Only"                      Source="Windows_X64_Only.mof"                     />
      <Filter Name="Windows_X86_Only"                      Source="Windows_X86_Only.mof"                     />
      <Filter Name="Windows_Server_Only"                   Source="Windows_Server_Only.mof"                  />
      <Filter Name="Windows_Server_2016_And_Newer_Only"    Source="Windows_Server_2016_And_Newer_Only.mof"   />
      <Filter Name="Windows_Server_2012_R2_And_Older_Only" Source="Windows_Server_2012_R2_And_Older_Only.mof"/>
      <Filter Name="Windows_Client_Only"                   Source="Windows_Client_Only.mof"                  />
      <Filter Name="Windows_10_And_Newer_Only"             Source="Windows_10_And_Newer_Only.mof"            />
      <Filter Name="Windows_8.1_And_Older_Only"            Source="Windows_8.1_And_Older_Only.mof"           />
    </WmiFilters>

    <!-- ################################################################################################################################# -->
    <!-- The <GPO> elements list the Group Policy added (or refreshed) to the target domain.                                               -->
    <!-- Each of this Group Policy is first generated with no data (if not existing), then data is imported from its backup folder.        -->
    <!--   > BackupID...: refer to the unique ID of the backup folder                                                                      -->
    <!--   > validation.: if set to  No, the GPO is created and overwrited from its backup. Yes will only link the GPO to its targets.     -->
    <!--   > Name.......: refer to the display name, as shown in the GUI                                                                   -->
    <!--   > Description: description label, as shown in the GUI.                                                                          -->
    <!--                                                                                                                                   -->
    <!-- The <GPOMODE> will identify the Tier perimeter (for group management) and mode to be applied.                                     -->
    <!--   > Tier.......: Tier0, Tier1 or Tier2.                                                                                           -->
    <!--   > Mode.......: APPLY, DENY or BOTH. Apply create a group that limit the application scope, whereas DENY enforce the application -->
    <!--                  to everyone except the denied one. BOTH mix the two modes, enforcing application to only a scoped target group   -->
    <!--                  with an exception scope (usefull for migration or testing purpose). If mode is ommited, the mode BOTH will be    -->
    <!--                  used.                                                                                                            -->
    <!--                                                                                                                                   -->
    <!-- The <gpoDeny> ID attribute will set the specified identity with permission "Deny Execute" - you can se as many input as requiered.-->
    <!--   > ID......: use either sAMAccountName, object GUID or SID to identify the target identity to deny.                              -->
    <!--                                                                                                                                   -->
    <!-- The <gpoLink> attribute Will link the GPO to the specified target - you can use as many input as requiered.                       -->
    <!--   > Path....: DistinguishedName of the target OU where the GPO have to be linked. Use "RootDN" to refer to the DN of the domain.  -->
    <!--   > Enabled.: "Yes", "No". Teach the script to enable the link or not.                                                            -->
    <!--   > Enforced: "Yes", "No". Teach the script to enforce this stratagy to any descending GPO that normally overcome its parameters. -->
    <!--                                                                                                                                   -->
    <!-- The <GpoFilter> parameter refers to the WMI filter that should be linked to this GPO.                                             -->
    <!--   > WMI.....: the Display Name of the target WMI filter to be used (you can refer to the name section of the MOF import)          -->
    <!--                                                                                                                                   -->
    <!-- The <GpoSecurityFilter> parameter tasks the script to set "authenticated users" as read only and add a security group as new      -->
    <!-- security filter extension.                                                                                                        -->
    <!-- ################################################################################################################################# -->

    <!-- GPO GROUP SETTINGS: used to generate APPLY and DENY Group Name. Use %tier% to mark the Tier localization in the new name          -->
    <!--   > GpoName..: define the group name for applying or denying a group                                                              -->
    <GlobalGpoSettings GroupName="G-S-%tier%-GPO_%GpoName%_%mode%" Tier0="T0" Tier1="T1" Tier2="T2">
      <GpoTier0 OU="OU=GPO,OU=Groups Tier 0,OU=Administration,%rootDN%"/>
      <GpoTier1 OU="OU=GPO,OU=Groups Tier 1,OU=Administration,%rootDN%"/>
      <GpoTier2 OU="OU=GPO,OU=Groups Tier 2,OU=Administration,%rootDN%"/>
    </GlobalGpoSettings>

    <!-- TEMPLATE
	  <GPO BackupID="{9A9AD00F-56D9-476C-9D65-CEAD0FB31B4F}"  Validation="Yes" Name="display name" Description="gpo description">
		<GpoFilter>WmiFilterName</GpoFilter>
		<GpoLink Path="RootDN" Enabled="No" Enforced="No"/>
    </GPO>
	  -->
	  <GPO BackupID="{50BCE76B-CE52-4024-A118-6592D4D6C76D}" Validation="Yes" Name="HAD_Activate_NLA_for_RDP_All" Description="GPO to enable NLA for RDP access">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{A69848CE-0866-4B9F-8E2C-E8F747FFE643}" Validation="Yes" Name="HAD_Activate_RDP_All" Description="GPO to enable RDP">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{483EF314-0049-4E87-AAE4-2F7BD57880D5}" Validation="Yes" Name="HAD_Auto-Update_S1_Thu_0h_Srv" Description="GPO to update servers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Server_Only"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{8DCAF7F7-3337-4153-AB20-35DBC567DBE5}" Validation="Yes" Name="HAD_Auto-Update_S1_Thu_1h_Srv" Description="GPO to update servers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Server_Only"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{EA431EAA-7D00-4ABA-9AB2-056E4D62B56F}" Validation="Yes" Name="HAD_Block_BloodHound_All" Description="GPO to block BloodHound tool (Netcease)">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{52819386-F865-4488-9344-5A965A244017}" Validation="Yes" Name="HAD_Block_Camera_On_Lockon_All" Description="Gpo to prevent enabling lock screen camera">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{5B716A6C-0A04-4E54-92F4-A35437E6A493}" Validation="Yes" Name="HAD_Block_Ms_3rd_Party_All" Description="Gpo to block third party Microsoft Windows components">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{5C9A26D9-2653-4445-B1F8-70AC55001AB4}" Validation="Yes" Name="HAD_Block_MSLive_Accounts_All" Description="GPO to block authentication with Microsoft Live accounts">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{FE441D8E-C34D-4447-9D98-790AC0F96781}" Validation="Yes" Name="HAD_Block-Anonymous_SAM-Enum_All" Description="GPO to block anonymous access and SAM enumeration">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{3DD11A05-4247-458C-8259-4DCD24B4FA95}" Validation="Yes" Name="HAD_Block_WinRM_All" Description="GPO to block WINRM">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{143D43A5-B198-4670-9A95-D3324FEB51B9}" Validation="Yes" Name="HAD_Logon_Cache_Wks" Description="GPO to configure session cache for workstations">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Client_Only"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{AEFF1D54-8DA7-4C43-8020-9C8F8782A5B8}" Validation="Yes" Name="HAD_Disable_NTLM1_LM_All" Description="GPO to disable LM and NTLMV1 protocol">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{B186130D-9C11-43CA-98BC-AC4FA17D3350}" Validation="Yes" Name="HAD_Configure_NTLMv2_128bits_All" Description="GPO to configure NTLM V2 128 bits encryption">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{14D52768-A2E5-44D4-AE6D-2358020C4FDD}" Validation="Yes" Name="HAD_Configure_SMB-Signing_All" Description="GPO to sign SMB communication">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{6A4055FA-342E-40F6-8288-76B1CBE1B8F0}" Validation="Yes" Name="HAD_Disable_LDAP-Bind-Simple_All" Description="GPO to disable LDAP Bind Simple">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{F02F69CE-DC45-4328-BCDC-06D068CAE2F1}" Validation="Yes" Name="HAD_Disable_LLMNR_All" Description="GPO to disable LLMNR">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{8CD36574-017F-4CA6-8A15-012C28F7A77E}" Validation="Yes" Name="HAD_Disable_LMHASH_All" Description="GPO to disable LMHASH">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{472BD4D4-11AE-467D-AA10-77A5140E7711}" Validation="Yes" Name="HAD_Disable_Allow-Game-DVR_Service_Wks" Description="GPO to disable AllowGameDVR service">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Client_Only"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{9BB7F0DF-C2A9-437C-B809-7C67983DA70A}" Validation="Yes" Name="HAD_Disable_SMBv1_All" Description="GPO to disable SMB V1 protocol">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{EE72E1FB-8097-4D3D-8991-641C6CC119E5}" Validation="Yes" Name="HAD_Disable_SSL2_SSL3_All" Description="GPO to disable SSL2 and SSL 3.0 protocol">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{C494C564-A2D6-4E25-9EE9-E5B8C020514B}" Validation="Yes" Name="HAD_Disable_Posix-Subsystem_All" Description="GPO do disable Posix subsystem">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{776E2476-4FFE-4871-BE77-06D4107365BA}" Validation="Yes" Name="HAD_Disable_Win11_Update_Wks" Description="GPO to disable Windows automatic update">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Client_Only"/>      
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{7DC13E05-B103-40DF-ACBA-F298BD4A3015}" Validation="Yes" Name="HAD_Enforce_Symbolic-Links_All" Description="GPO to enforce symbolic links">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{B4B92D69-F38A-4971-84AC-DFE918C15C4A}" Validation="Yes" Name="HAD_FIPS_Cryptography_All" Description="GPO to enable FIPS cryptography">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{8B32B75A-600F-4A46-A560-54D44608B65B}" Validation="Yes" Name="HAD_Firewall_Audit_Only_All" Description="GPO to configure Microsoft Firewall on audit mode">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{D7D2F975-F33E-4E90-B2C9-65A08DAD1025}" Validation="Yes" Name="HAD_Firewall_Block_Inbound_All" Description="GPO to enable Microsoft Firewall (inboud trafic)">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{F0D513AE-4996-456E-A79D-1E1323C47BE7}" Validation="Yes" Name="HAD_GPO_Refresh_Cycle_20min_All" Description="GPO to force group policy refresh interval to 20 minutes">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>

	  <GPO BackupID="{67E776A2-4A51-477F-9319-EC5D9341F4F6}" Validation="Yes" Name="HAD_Login_Restrictions_Paw" Description="GPO to manage who can open a session on a Paw">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
    </GPO>
  	<GPO BackupID="{A7B725E8-4D15-4592-B3EC-679A2D5B8F01}" Validation="Yes" Name="HAD_Login_Restrictions_T0_All" Description="GPO to manage who can open a session on a Tier 0 computers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=Harden - Tier 0,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{59821253-CDBD-4A92-965C-15F891F4741E}" Validation="Yes" Name="HAD_Login_Restrictions_T0_Paw" Description="GPO to manage who can open a session on a Tier 0 Paw">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="OU=PAW Tier 0,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{F556AEB8-C08B-4B3D-ACAA-F42EB46D5DDA}" Validation="Yes" Name="HAD_Login_Restrictions_T1_All" Description="GPO to manage who can open a session on T1 servers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
    </GPO>
  	<GPO BackupID="{19B7644F-21D5-425C-99D1-81B59649BAA5}" Validation="Yes" Name="HAD_Login_Restrictions_T1_Paw" Description="GPO to manage who can open a session on Tier 1 Paw">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="OU=PAW Tier 1,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{29328AD4-93D0-43AB-974F-FE4AC33D1E30}" Validation="Yes" Name="HAD_Login_Restrictions_T12_All" Description="GPO to manage who can open a session on workstations (Tier 2) and Tier 1 servers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="OU=Harden - Tier 1 and 2,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{41287CF3-810A-4104-9622-DA2FC940844F}" Validation="Yes" Name="HAD_Login_Restrictions_T2_All" Description="GPO to manage who can open a session on workstations (Tier 2)">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
    </GPO>    
  	<GPO BackupID="{FC0409A6-4C0D-4071-97E4-A97D82C362A9}" Validation="Yes" Name="HAD_Login_Restrictions_T2_Paw" Description="GPO to manage who can open a session on Tier 2 Paw">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="OU=PAW Tier 2,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{DACA274C-0713-4E8A-A5EA-D655310EB2BC}" Validation="Yes" Name="HAD_Login_Restrictions_TLeg_All" Description="GPO to manage who can open a session on Tier Legacy computers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="OU=Harden - Tier Legacy,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{8BCA417B-0356-4AD5-898C-99363F4DFAB0}" Validation="Yes" Name="HAD_Login_Restrictions_TLeg_Paw" Description="GPO to manage who can open a session on Tier Legacy Paw">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="OU=PAW Tier Legacy,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
           
  	<GPO BackupID="{C53332F8-73B7-488D-81F4-148F3D0C077A}" Validation="Yes" Name="HAD_Logs_ANSSI_All" Description="GPO to configure Windows audit log">
		  <GpoMode Mode="BOTH" Tier="Tier0"/> 
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{34C20D17-4EB8-48FF-AC29-F34441014A28}" Validation="Yes" Name="HAD_PowerShell_Logs_All" Description="GPO to enable PowerShell V5 logs">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{F31780F6-6578-461B-96D9-79A2D4C648F2}" Validation="Yes" Name="HAD_Secure_NetLogon_All" Description="GPO to secure Netlogon (encryption and password change of computer accounts">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{F0CB3701-497A-440F-ABBD-019FF8D26F9C}" Validation="Yes" Name="HAD_UAC_Enforced_All" Description="GPO to apply UAC to Builtin administrator account">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{B3AD14F6-7688-44D0-AB76-DFF290D84D66}" Validation="Yes" Name="HAD_Win10_Auto_Update_Wks" Description="GPO to update Windows 10 computers with Windows Update for Business">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_10_And_Newer_Only"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{858E0F6B-EF3A-4081-8130-D6EF79A8E75A}" Validation="Yes" Name="HAD_Win8_Auto_Update_Wks" Description="GPO to update Windows 7 and 8 computers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_8.1_And_Older_Only"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{8B614881-5A7C-49DC-8163-EFF27184AF9F}" Validation="Yes" Name="HAD_Local-Admins_T0-Srv" Description="GPO to manage who are members of local administrators group on Tier 0 servers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Server_Only"/>
		  <GpoLink Path="OU=Harden - Tier 0,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{CA7DDE19-26C4-42C9-B3BF-EDA26DBE30A2}" Validation="Yes" Name="HAD_Local-Admins_T0-Wks" Description="GPO to manage who are members of local administrators group on Tier 0 workstations">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Client_Only"/>
		  <GpoLink Path="OU=Harden - Tier 0,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{8F931509-D88E-4C31-AE62-86770B006DBA}" Validation="Yes" Name="HAD_Local-Admins_T1-Srv" Description="GPO to manage who are members of local administrators group on Tier 1 servers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Server_Only"/>
		  <GpoLink Path="OU=Harden - Tier 1 and 2,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{906DD0F1-73BA-4594-B4D2-4D881D32496E}" Validation="Yes" Name="HAD_Local-Admins_T2-Wks" Description="GPO to manage who are local administrators on a Tier 2 workstations">
		  <GpoMode Mode="BOTH" Tier="Tier0"/> 
      <GpoFilter WMI="Windows_Client_Only"/>
		  <GpoLink Path="OU=Harden - Tier 1 and 2,RootDN" Enabled="Yes" Enforced="Yes"/>
		  <GpoLink Path="OU=Computers,OU=Provisionning,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{0D861C4B-37F0-4B51-AF73-22C8B432D3E0}" Validation="Yes" Name="HAD_Local-Admins_TLeg-Wks" Description="GPO to manage who are local administrators on Tier Legacy workstations">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Client_Only"/>
		  <GpoLink Path="OU=Harden - Tier Legacy,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{A4C7CFCD-81A4-4C32-B70B-A66E3F3F30F8}" Validation="Yes" Name="HAD_Local-Admins_TLeg_Srv" Description="GPO to manage who are local administrators on Tier Legacy servers">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Server_Only"/>
		  <GpoLink Path="OU=Harden - Tier Legacy,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
	  <GPO BackupID="{7DB87126-0B26-4F62-9618-C7246109A279}" Validation="Yes" Name="HAD_Clear_PageFile_Shutdown_All" Description="GPO to clear Pagefile at shutdown">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{D6B346F9-0FE1-4303-A064-0B4ABEB73A39}" Validation="Yes" Name="HAD_Configure_Screenlock_All" Description="GPO to lock inactive session automatically">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{8C391429-CEEE-4C5B-8D9D-BB44CC184694}" Validation="Yes" Name="HAD_Configure_Windows-Defender_All" Description="GPO to enable and configure Microsoft Defender">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
    </GPO>
  	<GPO BackupID="{4FDEEE0E-A638-4C26-870E-872424AE3560}" Validation="Yes" Name="HAD_Disable_Print-Spooler_Service_Srv" Description="GPO to disable Print spooler">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Server_Only"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{D2AA6436-FF93-451F-B450-B12D2448E826}" Validation="Yes" Name="HAD_Disable_WDigest_All" Description="GPO to disable WDigest protocol">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{6FC4484D-102D-47DA-927F-0E1698F6E837}" Validation="Yes" Name="HAD_Enforce_UAC_All" Description="GPO to enable UAC">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{B5636A9F-C39D-4C75-9002-DA88B5ACB2E1}" Validation="Yes" Name="HAD_IPv4_Priority_All" Description="GPO to configure IPV4 as default IP protocol instead of IPV6">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{D00803F0-A729-407E-9BAD-32AC0E94EBE4}" Validation="Yes" Name="HAD_Local_Accounts_AllMembers" Description="GPO to enable and rename administrator local account and to disable and rename guest local account">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
		  <GpoLink Path="OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
      <GpoLink Path="OU=Harden - Tier 0,RootDN" Enabled="Yes" Enforced="Yes"/>
      <GpoLink Path="OU=Harden - Tier 1 and 2,RootDN" Enabled="Yes" Enforced="Yes"/>
		  <GpoLink Path="Harden - Tier Legacy,RootDN" Enabled="Yes" Enforced="Yes"/>
		  <GpoLink Path="OU=Computers,OU=Provisionning,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  	<GPO BackupID="{1A8E1970-BB62-4263-986A-FA2FD7E042CF}" Validation="Yes" Name="HAD_Logon_No_Cache_Srv" Description="GPO to disable logon cache for server">
		  <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows_Server_Only"/>
		  <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  </GroupPolicies>

  <Accounts>
    <!-- ################################################################################################################################### -->
    <!-- The <Account> Section list all user identities to be generated by the script.                                                       -->
    <!-- The script first check if the account is already present in the domain (if so, nothing is done), and if not, it will generatae it.  -->
    <!-- The newly created user is then stored with its random password in a keepass file (.\Outputs\HardenAD.kbdx).                         -->
    <!-- Each account is provided with the following input:                                                                                  -->
    <!--   > GivenName.....: the given name of the account                                                                                   -->
    <!--   > Surname.......: the surname of the account                                                                                      -->
    <!--   > sAMAccountName: the sAMAccountName of the account                                                                               -->
    <!--   > displayName...: the name displayed by the GUI                                                                                   -->
    <!--   > Description...: the description of the account                                                                                  -->
    <!--   > Path..........: the distingsuihedName of the OU containing the account. you can use ROOTDN to refer to the domain DN            -->
    <!-- ################################################################################################################################### -->
    <!-- Tier 0 accounts - Manager -->
    <User DisplayName="Loic VEIRMAN (T0M)" Surname="VEIRMAN" samAccountName="T0M-LVEIRMAN" GivenName="Loic" Description="Loic Veirman (Tier 0 Manager)" Path="OU=Users Tier 0,OU=Administration,ROOTDN"/>

    <!-- Tier 1 accounts - Managers -->
    <User DisplayName="Sylvain VEIRMAN (T1M)" Surname="VEIRMAN" samAccountName="T1M-SVEIRMAN" GivenName="Sylvain" Description="Sylvain Veirman (Tier 1 Manager)" Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>

    <!-- Tier 1 accounts - Administrators -->
    <User DisplayName="Jean-Paul VEIRMAN (T1A)" Surname="VEIRMAN" samAccountName="T1A-JPVEIRMAN" GivenName="Jean-Paul" Description="Jean-Paul Veirman (Tier 1 Administrator)" Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>

    <!-- Tier 1 accounts - Operators -->
    <User DisplayName="Loic VEIRMAN (T1O)"      Surname="VEIRMAN" samAccountName="T1O-LVEIRMAN"  GivenName="Loic"      Description="Loic Veirman (Tier 0 Operator)"      Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>
    <User DisplayName="Sylvain VEIRMAN (T1O)"   Surname="VEIRMAN" samAccountName="T1O-SVEIRMAN"  GivenName="Sylvain"   Description="Sylvain Veirman (Tier 1 Operator)"   Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>
    <User DisplayName="Jean-Paul VEIRMAN (T1O)" Surname="VEIRMAN" samAccountName="T1O-JPVEIRMAN" GivenName="Jean-Paul" Description="Jean-Paul Veirman (Tier 1 Operator)" Path="OU=Users Tier 1,OU=Administration,ROOTDN"/>

    <!-- Tier 2 accounts - Managers -->
    <User DisplayName="Yolande VEIRMAN (T2M)" Surname="VEIRMAN" samAccountName="T2M-YVEIRMAN" GivenName="Yolande" Description="Yolande Veirman (Tier 2 Manager)" Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>

    <!-- Tier 2 accounts - Administrators -->
	<User DisplayName="Chantal VEIRMAN (T2A)" Surname="VEIRMAN" samAccountName="T2A-CVEIRMAN" GivenName="Chantal" Description="Chantal Veirman (Tier 2 Adminstrator)" Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>
    
	<!-- Tier 2 accounts - Operators -->
    <User DisplayName="Loic VEIRMAN (T2O)"    Surname="VEIRMAN" samAccountName="T2O-LVEIRMAN" GivenName="Loic"    Description="Loic Veirman (Tier 2 Operator)"    Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>
    <User DisplayName="Yolande VEIRMAN (T2O)" Surname="VEIRMAN" samAccountName="T2O-YVEIRMAN" GivenName="Yolande" Description="Yolande Veirman (Tier 2 Operator)" Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>
	<User DisplayName="Chantal VEIRMAN (T2O)" Surname="VEIRMAN" samAccountName="T2O-CVEIRMAN" GivenName="Chantal" Description="Chantal Veirman (Tier 2 Operator)" Path="OU=Users Tier 2,OU=Administration,ROOTDN"/>

	<!-- Tier Legacy accounts - Operators -->
    <User DisplayName="Loic VEIRMAN (TLO)"      Surname="VEIRMAN" samAccountName="TLO-LVEIRMAN"  GivenName="Loic"      Description="Loic Veirman (Tier Legacy Operator)"      Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <User DisplayName="Sylvain VEIRMAN (TLO)"   Surname="VEIRMAN" samAccountName="TLO-SVEIRMAN"  GivenName="Sylvain"   Description="Sylvain Veirman (Tier Legacy Operator)"   Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <User DisplayName="Jean-Paul VEIRMAN (TLO)" Surname="VEIRMAN" samAccountName="TLO-JPVEIRMAN" GivenName="Jean-Paul" Description="Jean-Paul Veirman (Tier Legacy Operator)" Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
    <User DisplayName="Yolande VEIRMAN (TLO)"   Surname="VEIRMAN" samAccountName="TLO-YVEIRMAN"  GivenName="Yolande"   Description="Yolande Veirman (Tier Legacy Operator)"   Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
	<User DisplayName="Chantal VEIRMAN (TLO)"   Surname="VEIRMAN" samAccountName="TLO-CVEIRMAN"  GivenName="Chantal"   Description="Chantal Veirman (Tier Legacy Operator)"   Path="OU=Users Tier Legacy,OU=Administration,ROOTDN"/>
  </Accounts>

  <Groups>
    <!-- ################################################################################################################################### -->
    <!-- The <Groups> Section list all group identities to be generated by the script.                                                       -->
    <!-- The script first check if the group is already present in the domain (if so, nothing is done), and if not, it will generatae it.    -->
    <!-- Each group is provided with the following input:                                                                                    -->
    <!--   > Name..........: the name of the group, also its display name and sAMAccountName                                                 -->
    <!--   > Description...: the description of the group                                                                                    -->
    <!--   > Scope.........: domainLocal, Local, Global or Universal                                                                         -->
    <!--   > Category......: security or distribution                                                                                        -->
    <!--                                                                                                                                     -->
    <!-- In a second time, all groups are populated with the <member> input.                                                                 -->
    <!--   > sAMAccountName: the sAMAccountName of the target member.                                                                        -->
    <!-- ################################################################################################################################### -->
    <!-- #### TIER 0 #### -->
    <Group name="G-S-T0_Managers" Category="Security" Scope="Global" Description="Members of this group can see and manage all the Active Directory objects" Path="OU=Groups Tier 0,OU=Administration,ROOTDN">
      <Member samAccountName="T0M-LVEIRMAN"/>
    </Group>

    <Group name="L-S-T0_LocalAdmins_Servers" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier 0,OU=Administration,ROOTDN">
    </Group>
    <Group name="L-S-T0_LocalAdmins_Workstations" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier 0,OU=Administration,ROOTDN">
    </Group>

    <!-- #### TIER 1 #### -->
	<Group name="G-S-T1_Managers" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 1 ressources, including T1 admin users and groups" Path="OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="T1M-SVEIRMAN"/>
    </Group>

    <Group name="G-S-T1_Administrators" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 1 ressources, excluding T1 admin users and groups" Path="OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="T1A-JPVEIRMAN"/>
    </Group>

    <Group name="G-S-T1_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier 1 resources (login)" Path="OU=Groups Tier 1,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T1-DELEG_Group - Manage Membership" Category="Security" Scope="domainLocal" Description="Members of this group can add and remove members of tier 1 groups within productions OUs" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="T1O-LVEIRMAN"/>
      <Member samAccountName="T1O-SVEIRMAN"/>
      <Member samAccountName="T1O-JPVEIRMAN"/>
    </Group>

    <Group name="L-S-T1-DELEG_Group - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>
 
	<Group name="L-S-T1-DELEG_Group - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within Tier 1 Administration OU" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_User - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_User - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within Tier 1 administration OU" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_Computer - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete commputers within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_Contact - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete contact within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T1_LocalAdmins_Servers" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier 1,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T1-DELEG_LAPS_PwdRead" Category="Security" Scope="domainLocal" Description="Members of this group will be able to read LAPS password for workstations" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Operators"/>
    </Group>

    <Group name="L-S-T1-DELEG_LAPS_PwdReset" Category="Security" Scope="domainLocal" Description="Members of this group will be able to reset LAPS password for workstations" Path="OU=Deleg,OU=Groups Tier 1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
    </Group>

    <!-- #### TIER 2 #### -->
    <Group name="G-S-T2_Managers" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 2 ressources, including T1 admin users and groups" Path="OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="T2M-YVEIRMAN"/>
    </Group>

    <Group name="G-S-T2_Administrators" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 2 ressources, excluding T1 admin users and groups" Path="OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="T2A-CVEIRMAN"/>
    </Group>

    <Group name="G-S-T2_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier 2 resources (login)" Path="OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="T2O-LVEIRMAN"/>
      <Member samAccountName="T2O-CVEIRMAN"/>
      <Member samAccountName="T2O-YVEIRMAN"/>
    </Group>

    <Group name="L-S-T2-DELEG_Group - Manage Membership" Category="Security" Scope="domainLocal" Description="Members of this group can add and remove members of tier 1 groups within productions OUs" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_Group - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T2-DELEG_Group - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within Tier 1 Administration OU" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_User - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_User - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within Tier 1 administration OU" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_Computer - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete commputers within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_Contact - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete contact within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2_LocalAdmins_Workstations" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier 2,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T2-DELEG_LAPS_PwdRead" Category="Security" Scope="domainLocal" Description="Members of this group will be able to read LAPS password for workstations" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Operators"/>
    </Group>

    <Group name="L-S-T2-DELEG_LAPS_PwdReset" Category="Security" Scope="domainLocal" Description="Members of this group will be able to reset LAPS password for workstations" Path="OU=Deleg,OU=Groups Tier 2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
    </Group>

    <!-- #### TIER LEGACY #### -->
    <Group name="G-S-TL_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier Legacy resources (login)" Path="OU=Groups Tier Legacy,OU=Administration,ROOTDN">
      <Member samAccountName="TLO-LVEIRMAN"/>
      <Member samAccountName="TLO-CVEIRMAN"/>
      <Member samAccountName="TLO-YVEIRMAN"/>
      <Member samAccountName="TLO-SVEIRMAN"/>
      <Member samAccountName="TLO-JPVEIRMAN"/>
    </Group>

    <Group name="L-S-TL_LocalAdmins_Servers" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier Legacy,OU=Administration,ROOTDN">
    </Group>
    <Group name="L-S-TL_LocalAdmins_Workstations" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=Local Admins,OU=Groups Tier Legacy,OU=Administration,ROOTDN">
    </Group>  
  </Groups>
  
  <DefaultMembers>
    <!-- ################################################################################################################################### -->
    <!-- The <DefaultMembers> Section list strictely allowed members of a specified group.                                                   -->
    <!-- When the script call the function "Reset-GroupMembership", the function will use this data to leave only mandatory identity.        -->
    <!--   > Member: either a SID or a sAMAccountName. Use %domainSID% to dynamically replace it by the domain SID.                          -->
    <!-- ################################################################################################################################### -->
    <!-- Builtin\Administrators -->
    <Group Target="S-1-5-32-544">
      <Member>%DomainSID%-500</Member>
      <Member>%DomainSID%-512</Member>
      <Member>%DomainSID%-519</Member>
    </Group>
    <!-- Domain Admins -->
    <Group Target="%DomainSID%-512">
      <Member>%DomainSID%-500</Member>
    </Group>
    <!-- Enterprise Admins -->
    <Group Target="%DomainSID%-519">
      <Member>%t0-Managers%</Member>
    </Group>
    <!-- Protected Users -->
    <Group Target="%DomainSID%-525">
      <Member>%t0-managers%</Member>
    </Group>
  </DefaultMembers>
  
  <TaskSchedules BaseDir="C:\_ADM\TasksSchedulesScripts">
    <!-- ################################################################################################################################### -->
    <!-- the <TaskSchedules> section define the sched. tasks to add to the running system and is called by the function New-ScheduleTasks.   -->
    <!-- The following parameters are expected:                                                                                              -->
    <!--   > Name......: The scheduled tasks name, as shown in the GUI.                                                                      -->
    <!--   > Xml.......: The xml file containing a backup of the new scheduled tasks and located in .\Inputs\ScheduleTasks\TasksSchedulesXml -->
    <!--   > SchedCmd..: The executable to be used. It will replace the %command% in the xml file.                                           -->
    <!--   > SchedArg..: The arguments line to pass to the executable. If a script is specified, it should present in                        -->
    <!--                 .\Inputs\ScheduleTasks\TasksSchedulesScripts                                                                        -->
    <!--   > SchedDir..: The effective path context when the schedule is run - use %BaseDir% to refer to the directory value speciefied in   -->
    <!--                 the "BaseDir" parameters of the section <TaskSchedules> (this one, yup).                                            -->
    <!--   > SchedDsc..: The description field for this task.                                                                                -->
    <!--   > SchedPth..: The folder name where the task will be stored in the Tasks Scheduler console.                                       -->
    <!-- ################################################################################################################################### -->
    <!-- flushing Sensible groups with MCS-GroupsFlushing.ps1 -->
    <SchedTask Name="MCS - Sensitive Groups Flushing" Xml="MCS-GroupsFlushing.xml">
      <SchedCmd>powershell.exe</SchedCmd>
      <SchedArg>-windowstyle hidden -file .\MCS-GroupsFlushing.ps1</SchedArg>
      <SchedDir>%BaseDir%\MCS-GroupsFlushing</SchedDir>
      <SchedDsc>Flush highly sensitive groups (see MCS-GroupsScheduling.csv for details)</SchedDsc>
      <SchedPth>HardenAD</SchedPth>
    </SchedTask>
  </TaskSchedules>

  <LocalAdminPasswordSolution>
    <!-- ################################################################################################################################### -->
    <!-- The <LocalAdminPasswordSolution> is used to setup LAPS over an existing domain. 													 -->
	  <!-- By default, the model delegate permission to Tier 1 for servers and Tier 2 for workstations. All others are handled by Dom admins.  -->
    <!--                                                                                                                                     -->
    <!-- SelfPermission: Add Write Permission to ms-Mcs-AdmPwdExiprationTime and ms-Mcs-AdmPwd attribute to SELF (i.e. the computer object). -->
	  <!-- PasswordReader: Offer the ability to read ms-Mcs-AdmPwd which contains the local user password                                      -->
	  <!-- PasswordReset.: Offer the ability to read and write ms-Mcs-AdmPwdExiprationTime and ms-Mcs-AdmPwd attribute						 -->
	  <!--                                                                                                                                     -->
	  <!-- The script now handles dynamic group mapping and will look at the <Translation> section of this document.							 -->
	  <!--                                                                                                                                     -->	
	  <!-- <AdmPwdSelfPermission>:                                                                                                             -->
    <!--    Target: target OU distinguished name with computer objects. use "RootDN" to dynamically specify the domain distanguished name.   -->
    <!--                                                                                                                                     -->
    <!-- <AdmPwdPasswordreader>:                                                                                                             -->
    <!--    Target: target OU distinguished name with computer objects. use "RootDN" to dynamically specify the domain distanguished name.   -->
    <!--    Id....: Specific the group sAMAccountName to be granted with the password read permission on the target OU.                      -->
    <!--                                                                                                                                     -->
    <!-- <AdmPwdPasswordreset>:                                                                                                              -->
    <!--    Target: target OU distinguished name with computer objects. use "RootDN" to dynamically specify the domain distanguished name.   -->
    <!--    Id....: Specific the group sAMAccountName to be granted with the password reset permission on the target OU.                     -->
    <!-- ################################################################################################################################### -->
    <AdmPwdSelfPermission Target="OU=Servers,OU=Harden - Tier Legacy,%RootDN%"/>
    <AdmPwdSelfPermission Target="OU=Servers,OU=Harden - Tier 1 and 2,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=Workstations,OU=Harden - Tier Legacy,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=Workstations,OU=Harden - Tier 1 and 2,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=PAW Tier 0,OU=Administration,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=PAW Tier 1,OU=Administration,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=PAW Tier 2,OU=Administration,%RootDN%"/>
	  <AdmPwdSelfPermission Target="OU=PAW Tier Legacy,OU=Administration,%RootDN%"/>
	
	  <AdmPwdPasswordReader Target="OU=Servers,OU=Harden - Tier Legacy,%RootDN%"       Id="%domain%\%T1-LAPS-PasswordReader%"/>
    <AdmPwdPasswordReader Target="OU=Servers,OU=Harden - Tier 1 and 2,%RootDN%"      Id="%domain%\%T1-LAPS-PasswordReader%"/>
    <AdmPwdPasswordReader Target="OU=Workstations,OU=Harden - Tier Legacy,%RootDN%"  Id="%domain%\%T2-LAPS-PasswordReader%"/>
    <AdmPwdPasswordReader Target="OU=Workstations,OU=Harden - Tier 1 and 2,%RootDN%" Id="%domain%\%T2-LAPS-PasswordReader%"/>
    
	  <AdmPwdPasswordReset  Target="OU=Servers,OU=Harden - Tier Legacy,%RootDN%"       Id="%domain%\%T1-LAPS-PasswordReset%"/>
    <AdmPwdPasswordReset  Target="OU=Servers,OU=Harden - Tier 1 and 2,%RootDN%"      Id="%domain%\%T1-LAPS-PasswordReset%"/>
    <AdmPwdPasswordReset  Target="OU=Workstations,OU=Harden - Tier Legacy,%RootDN%"  Id="%domain%\%T2-LAPS-PasswordReset%"/>
    <AdmPwdPasswordReset  Target="OU=Workstations,OU=Harden - Tier 1 and 2,%RootDN%" Id="%domain%\%T2-LAPS-PasswordReset%"/>	
  </LocalAdminPasswordSolution>

  <Sequence>
    <!-- ################################################################################################################################### -->
    <!-- the <Sequence> section define the different tasks to iterate in "sequence" (can't resist to this one).                              -->
    <!-- To deal with highlight color in display, use the ` to initiate and end a color change in your string, then use one of the three     -->
    <!-- characters specified in value AltBaseHTxt(A,B, or C) to select your color: the color will switch back to normal at the next `.      -->
    <!--			                                                                                                                         -->
    <!-- The default highlight values are those one:                                                                                         -->
    <!--   > `[my text` : magenta                                                                                                            -->
    <!--   > `(my text` : yellow                                                                                                             -->
    <!--   > `{my text` : gray                                                                                                               -->
    <!--			                                                                                                                         -->
    <!-- Some special inputs are usefull to replace value dynamically :                                                                   	 -->
    <!--	 > FileName   : replace with the value of this file                                                                              -->
    <!--	 > RootDN     : replace with domain root DN                                                                                      -->
    <!--			                                                                                                                         -->
    <!-- Each task ID is executed in sequence, based on the Number vaue (ascending). Each Task ID use the following attributes:              -->
    <!--   > Number         : Define the squence order, the lowest will be run first.                                                        -->
    <!--   > Name           : ID task name as refered in the final log output.                                                               -->
    <!--   > CallingFunction: Name of the function to be called from one of the .psm1 files present in the modules directory.                -->
    <!--   > UseParameters  : Mandatory (but could be empty). Specify parameter to pass as argument to CallingFunction.                      -->
    <!--                      Use on per parameter and sort them in sequence (your script should refer them using input ordering).           -->
    <!--   > TaskEnabled    : YES or NO. When set to NO, the tasks is disabled and will not be applied.                                      -->
    <!-- ################################################################################################################################### -->

    <!-- SET MS-DS-MACHINEACCOUNTQUOTA TO 0                                                                                                  -->
    <Id Number="010" Name="Restrict computer junction to the domain">
      <CallingFunction>Set-msDSMachineAccountQuota</CallingFunction>
      <!--Parameter: new ms-DS-MachineAccountQuota value                                                                                     -->
      <UseParameters>0</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(msDSMachineAccountQuota` to `(0` to restrict domain junction</TaskDescription>
    </Id>

    <!-- ENABLE THE AD RECYCLE BIN                                                                                                           -->
    <Id Number="020" Name="Activate Active Directory Recycle Bin">
      <CallingFunction>Set-ADRecycleBin</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>activate the `(AD Recycle Bin` optional feature</TaskDescription>
    </Id>

    <!-- CONFIGURE ALL AD SITE LINKS WITH THE NOTIFY OPTIONS                                                                                 -->
    <Id Number="030" Name="Set Notify on every Site Links">
      <CallingFunction>Set-SiteLinkNotify</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(notify` on every `(Site Links</TaskDescription>
    </Id>

    <!-- ACTIVATE THE GPO CENTRAL STORE                                                                                                      -->
    <Id Number="040" Name="Set GPO Central Store">
      <CallingFunction>Set-GpoCentralStore</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(GPO Central Store` and update `{adm` and `{admx` files</TaskDescription>
    </Id>

    <!-- GENERATE NEW ADMINISTRATION ORGANIZATIONAL UNIT                                                                                     -->
    <Id Number="050" Name="Set Administration Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_ADMIN</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Administration` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW TIER 0 ORGANIZATIONAL UNIT                                                                                     -->
    <Id Number="051" Name="Set Tier 0 Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_PROD-T0</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Tier 0` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW TIER 1 and 2 ORGANIZATIONAL UNIT                                                                                     -->
    <Id Number="052" Name="Set Tier 1 and Tier 2 Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_PROD-T1and2</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Tier 1 and Tier 2 combo` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW LEGACY ORGANIZATIONAL UNIT                                                                                     -->
    <Id Number="053" Name="Set Legacy Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_PROD-LEGACY</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Tier Legacy` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW DEFAULT OBJECTS LOCATION TREE                                                                                          -->
    <Id Number="060" Name="Set Provisionning Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>PROVISIONNING-EN</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(Provisionning` organizational unit</TaskDescription>
    </Id>

    <!-- RELOCATE NEW USER/GROUP OBJECT LOCATION                                                                                             -->
    <Id Number="070" Name="Default user location on creation">
      <CallingFunction>Set-DefaultObjectLocation</CallingFunction>
      <!--Parameter: user or computer                                                                                                        -->
      <UseParameters>User</UseParameters>
      <!--Parameter: OU distinguishedName. Use RootDN to automatically fill-in the domain name                                               -->
      <UseParameters>OU=users,OU=provisionning,RootDN</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(user objects` default location</TaskDescription>
    </Id>

    <!-- RELOCATE NEW COMPUTER OBJECT LOCATION                                                                                             -->
    <Id Number="071" Name="Default computer location on creation">
      <CallingFunction>Set-DefaultObjectLocation</CallingFunction>
      <!--Parameter: user or computer                                                                                                      -->
      <UseParameters>Computer</UseParameters>
      <!--Parameter: OU distinguishedName. Use RootDN to automatically fill-in the domain name                                             -->
      <UseParameters>OU=computers,OU=provisionning,RootDN</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>set `(computer objects` default location</TaskDescription>
    </Id>

    <!-- GENERATE NEW ADMIN ACCOUNTS ON WHICH THE DELEGATION MODEL WILL WORKS                                                              -->
    <Id Number="080" Name="Create administration accounts">
      <CallingFunction>New-AdministrationAccounts</CallingFunction>
      <!-- Parameter: KeePass password for the kdbx database                                                                               -->
      <UseParameters>H4rd3n@D!!</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>create `(administration accounts` used by the tier model</TaskDescription>
    </Id>

    <!-- GENERATE NEW ADMIN GROUPS ON WHICH THE DELEGATION MODEL WILL WORKS                                                                -->
    <Id Number="090" Name="Create administration groups">
      <CallingFunction>New-AdministrationGroups</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>create `(administration groups` used by the tier model</TaskDescription>
    </Id>

    <!-- ACEs DEPLOYMENT FOR DELEGATION MODEL                                                                                               -->
    <Id Number="095" Name="Enforce delegation model through ACEs">
      <CallingFunction>Push-DelegationModel</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Enforce `(Delegation ACEs` used by the tier model</TaskDescription>
    </Id>

    <!-- IMPORT WMI FILTERS                                                                                                                -->
    <Id Number="125" Name="Import additional WMI Filters">
      <CallingFunction>Import-WmiFilters</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Import `(WMI filter` to the domain</TaskDescription>
    </Id>

    <!-- IMPORT GPOs                                                                                                                       -->
    <Id Number="130" Name="Import new GPO or update existing ones">
      <CallingFunction>New-GpoObject</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Import or update `(group policy objects` to the domain and link them</TaskDescription>
    </Id>

    <!-- LAPS SCHEMA UPDATE AND POWERSHELL TOOLING DEPLOYMENT                                                                              -->
    <!-- Warning: this only works with .Net 4.0 or greater.                                                                                -->
    <Id Number="134" Name="Update Ad schema for LAPS and deploy PShell tools">
      <CallingFunction>Install-Laps</CallingFunction>
      <!-- Parameter: ForceDcIsSchemaOwner (default) will require that the running system is also the Schema Master owner                  -->
      <!--            IgnoreDcIsSchameOwner will remove this requierment (child domain, etc.)                                              -->
      <UseParameters>ForceDcIsSchemaOwner</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Update `(AD Schema` for `[LAPS` and add `(PShell add-on`</TaskDescription>
    </Id>

    <!-- LAPS PERMISSIONS DEPLOYMENT OVER THE DOMAIN                                                                                       -->
    <Id Number="135" Name="Setup LAPS permissions over the domain">
      <CallingFunction>Set-LapsPermissions</CallingFunction>
      <!-- Parameter: CUSTOM : will teach the script to apply a fine-grained definition (refering to <LocalAdminPasswordSolution>)         -->
      <!--            DEFAULT: will apply permission at the root domain level and leave domain admins as the only allowed users.           -->
      <UseParameters>CUSTOM</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Set-up `(LAPS` permissions on the target domain</TaskDescription>
    </Id>

    <!-- LAPS DEPLOYMENT SCRIPT UDATE                                                                                                      -->
    <Id Number="136" Name="Update LAPS deployment scripts">
      <CallingFunction>Set-LapsScripts</CallingFunction>
      <!-- Parameter: use NETLOGON or SYSVOL for a dynamic location. Else enter the UNC Path                                               -->
      <UseParameters>NETLOGON\LAPS</UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Update `(LAPS Scripts` to match with the domain name</TaskDescription>
    </Id>

    <!-- IMPORT SCHEDULE TASKS                                                                                                             -->
    <Id Number="140" Name="Import schedule tasks on the running system">
      <CallingFunction>New-ScheduleTasks</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Import new `(schedule tasks` to the `[running system`</TaskDescription>
    </Id>

    <!-- RESET SENSIBLE GROUPS                                                                                                             -->
    <Id Number="150" Name="Reset Group Memberships">
      <CallingFunction>Reset-GroupMembership</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Reset `(groups's membeberships` to the `[trusted list`</TaskDescription>
    </Id>
  </Sequence>
</Settings>