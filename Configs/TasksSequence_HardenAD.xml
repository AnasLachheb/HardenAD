<?xml version="1.0" encoding="utf-8"?>
<Settings>
  <!-- ################################################################################################################################### -->
  <!-- Revision: 2022/07/08 - contact@hardenad.net                                                                                         -->
  <!-- ################################################################################################################################### -->
  <OrganizationalUnits>
    <!-- The section <ouTree> handle the base model for OU creation.                                                                       -->
    <!-- When calling the function [Set-OUTree], you need to add as parameter the "OU class" name of the tree structure you want to add.   -->
    <!-- This could also be used to manage new OU generation.                                                                              -->
    <ouTree>
      <!-- CLASS: HardenAD_ADMIN                                                                                                           -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_ADMIN" Name="Administration" Description="Privileged accounts administrative OU">
        <ChildOU>
          <Name>Paw</Name>
          <Description>First Node Privilege Admin Worstations</Description>
        </ChildOU>
        <ChildOU>
          <Name>PawT0</Name>
          <Description>Privilege Admin Worstations Tier 0 assets</Description>
        </ChildOU>
        <ChildOU>
          <Name>PawT12L</Name>
          <Description>Privilege Admin Worstations for Tier 1, Tier 2 and Tier Legacy assets</Description>
        </ChildOU>
        <ChildOU>
          <Name>GroupsT0</Name>
          <Description>Groups to manage Tier 0 objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>LocalAdmins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
          <ChildOU>
            <Name>Logon</Name>
            <Description>Groups used to login access to a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>UsersT0</Name>
          <Description>Users to manage Tier 0 objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>GroupsT1</Name>
          <Description>Groups to manage Tier 1 objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>LocalAdmins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>UsersT1</Name>
          <Description>Users to manage Tier 1 objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>GroupsT2</Name>
          <Description>Groups to manage Tier 2 objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>LocalAdmins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>UsersT2</Name>
          <Description>Groups to manage Tier 2 objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>GroupsT1L</Name>
          <Description>Groups to manage Legacy server objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>LocalAdmins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>UsersT1L</Name>
          <Description>Users to manage Legacy server objects</Description>
        </ChildOU>
        <ChildOU>
          <Name>GroupsT2L</Name>
          <Description>Groups to manage Legacy workstations objects</Description>
          <ChildOU>
            <Name>Deleg</Name>
            <Description>Groups used to delegate permissions on AD objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>GPO</Name>
            <Description>Groups used to allow or deny settings via Group Policies Objects</Description>
          </ChildOU>
          <ChildOU>
            <Name>LocalAdmins</Name>
            <Description>Groups used to grant a user being local administrator of a resource</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>UsersT2L</Name>
          <Description>Users to manage Legacy workstations objects</Description>
        </ChildOU>
      </OU>

      <!-- CLASS: HardenAD_PROD-T0                                                                                                         -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_PROD-T0" Name="Harden_T0" Description="Tier 0 resources">
        <ChildOU>
          <Name>Contacts</Name>
          <Description>Contacts objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups</Name>
          <Description>Groups objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Servers</Name>
          <Description>Computer objects belonging to this Tier and acting as servers</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Services</Name>
          <Description>Service accounts belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Service accounts synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled sevice accounts</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users</Name>
          <Description>User objects belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>User objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled user objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Workstations</Name>
          <Description>Computer Objects belonging to this Tier and acting as clients</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>

      </OU>

      <!-- CLASS: HardenAD_PROD-T1and2                                                                                                     -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_PROD-T1and2" Name="Harden_T12" Description="Tier 1 and Tier 2 resources">
        <ChildOU>
          <Name>Contacts</Name>
          <Description>Contacts objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups</Name>
          <Description>Groups objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Servers</Name>
          <Description>Computer objects belonging to this Tier and acting as servers</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Services</Name>
          <Description>Service accounts belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Service accounts synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled sevice accounts</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users</Name>
          <Description>User objects belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>User objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled user objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Workstations</Name>
          <Description>Computer Objects belonging to this Tier and acting as clients</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>

      </OU>

      <!-- CLASS: HardenAD_PROD-LEGACY                                                                                                     -->
      <!-- This class generate an OU tree used for administration purpose in a tiering model. This is the English Edtiion.                 -->
      <OU Class="HardenAD_PROD-LEGACY" Name="Harden_TL" Description="Legacy resources">
        <ChildOU>
          <Name>Contacts</Name>
          <Description>Contacts objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Groups</Name>
          <Description>Groups objects belonging to this Tier</Description>
        </ChildOU>
        <ChildOU>
          <Name>Servers</Name>
          <Description>Computer objects belonging to this Tier and acting as servers</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Services</Name>
          <Description>Service accounts belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Service accounts synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled sevice accounts</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Users</Name>
          <Description>User objects belonging to this Tier</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>User objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled user objects</Description>
          </ChildOU>
        </ChildOU>
        <ChildOU>
          <Name>Workstations</Name>
          <Description>Computer Objects belonging to this Tier and acting as clients</Description>
          <ChildOU>
            <Name>AADSync</Name>
            <Description>Computer objects synced with Azure AD</Description>
          </ChildOU>
          <ChildOU>
            <Name>Disabled</Name>
            <Description>Disabled computer objects</Description>
          </ChildOU>
        </ChildOU>

      </OU>

      <!-- CLASS: PROVISIONNING-EN                                                                                                         -->
      <!-- This class generate an OU tree used for provisioning objects in a default location. This is the English Edition.               -->
      <OU Class="PROVISIONNING-EN" Name="Provisioning" Description="New objects provisioning OU">
        <ChildOU>
          <Name>Users</Name>
          <Description>New user objects</Description>
        </ChildOU>

        <ChildOU>
          <Name>Computers</Name>
          <Description>New computer objects</Description>
        </ChildOU>
      </OU>
    </ouTree>
  </OrganizationalUnits>



  <!-- ################################################################################################################################# -->
  <!-- NEW SECTION (2022/07)                                                                                                             -->
  <!-- This section push delegation ACL to designated OU                                                                                 -->
  <!-- ################################################################################################################################# -->
  <DelegationACEs>
    <!-- Administration -->
    <!-- Delegation for L-S-T1-DELEG_Group - Create and Delete (administration) -->
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="group" TargetDN="OU=GroupsT1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType="" TargetDN="OU=GroupsT1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="group" TargetDN="OU=GroupsT1L,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete (administration)" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType="" TargetDN="OU=GroupsT1L,OU=Administration,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_Group - Create and Delete (administration) -->
    <ACL Trustee="L-S-T2-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="group" TargetDN="OU=GroupsT1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Group - Create and Delete (administration)" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType="" TargetDN="OU=GroupsT1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Group - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="group" TargetDN="OU=GroupsT2L,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Group - Create and Delete (administration)" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="Group" ObjectType="" TargetDN="OU=GroupsT2L,OU=Administration,ROOTDN"/>

    <!-- Delegation for L-S-T1-DELEG_User - Create and Delete (administration) -->
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="user" TargetDN="OU=UsersT1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType="" TargetDN="OU=UsersT1,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="user" TargetDN="OU=UsersT1L,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete (administration)" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType="" TargetDN="OU=UsersT1L,OU=Administration,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_User - Create and Delete (administration) -->
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="user" TargetDN="OU=UsersT2,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete (administration)" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType="" TargetDN="OU=UsersT2,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete (administration)" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="user" TargetDN="OU=UsersT2L,OU=Administration,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete (administration)" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType="" TargetDN="OU=UsersT2L,OU=Administration,ROOTDN"/>
    <!-- Production -->
    <!-- Delegation for L-S-T1-DELEG_Computer - Create and Delete -->
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="computer" TargetDN="OU=Servers,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType="" TargetDN="OU=Servers,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="computer" TargetDN="OU=Servers,OU=Harden_TL,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType="" TargetDN="OU=Servers,OU=Harden_TL,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="computer" TargetDN="OU=Computers,OU=Provisioning,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Computer - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType="" TargetDN="OU=Computers,OU=Provisioning,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_User - Create and Delete -->
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="user" TargetDN="OU=Services,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType="" TargetDN="OU=Services,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="user" TargetDN="OU=Services,OU=Harden_TL,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_User - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType="" TargetDN="OU=Services,OU=Harden_TL,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_Computer - Create and Delete -->
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="computer" TargetDN="OU=Workstations,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType="" TargetDN="OU=Workstations,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="computer" TargetDN="OU=Workstations,OU=Harden_TL,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType="" TargetDN="OU=Workstations,OU=Harden_TL,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="computer" TargetDN="OU=Computers,OU=Provisioning,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Computer - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="computer" ObjectType="" TargetDN="OU=Computers,OU=Provisioning,ROOTDN"/>
    <!-- Delegation for L-S-T1-DELEG_Group - Create and Delete -->
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="group" TargetDN="OU=Groups,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType="" TargetDN="OU=Groups,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="group" TargetDN="OU=Groups,OU=Harden_TL,ROOTDN"/>
    <ACL Trustee="L-S-T1-DELEG_Group - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType="" TargetDN="OU=Groups,OU=Harden_TL,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_contact - Create and Delete -->
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="contact" TargetDN="OU=contacts,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="contact" ObjectType="" TargetDN="OU=Contacts,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="contact" TargetDN="OU=Contacts,OU=Harden_TL,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Contact - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="contact" ObjectType="" TargetDN="OU=Contacts,OU=Harden_TL,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_User - Create and Delete -->
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="user" TargetDN="OU=Users,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType="" TargetDN="OU=Users,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="CreateChild, DeleteChild" RightType="Allow" Inheritance="All" InheritedObjects="" ObjectType="user" TargetDN="OU=Users,OU=Harden_TL,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_User - Create and Delete" Right="GenericAll" RightType="Allow" Inheritance="Descendents" InheritedObjects="user" ObjectType="" TargetDN="OU=Users,OU=Harden_TL,ROOTDN"/>
    <!-- Delegation for L-S-T2-DELEG_Group - Manage Membership -->
    <ACL Trustee="L-S-T2-DELEG_Group - Manage Membership" Right="ReadProperty, WriteProperty" RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType="" TargetDN="OU=Groups,OU=Harden_T12,ROOTDN"/>
    <ACL Trustee="L-S-T2-DELEG_Group - Manage Membership" Right="ReadProperty, WriteProperty" RightType="Allow" Inheritance="Descendents" InheritedObjects="group" ObjectType="" TargetDN="OU=Groups,OU=Harden_TL,ROOTDN"/>


  </DelegationACEs>

  <!-- ################################################################################################################################# -->
  <!-- NEW SECTION (2022/07)                                                                                                             -->
  <!-- This section create a reference table to be used through the scripts                                                              -->
  <!-- For now, only the GPO parts use this dynamic logic to fillup the migration and the preference table.                              -->
  <!--    > WellKnownID..: used to replace a dynamic pattern in a name (group, user, path, gpo, ...)                                     -->
  <!--    > Keyword......: used to shorten a word in a name (group, user, path, gpo, ...), helping in avoiding too long name in AD       -->
  <!-- ################################################################################################################################# -->
  <Translation>
    <wellKnownID objectClass="text" translateFrom="%AuthenticatedUsers%" translateTo="Authenticated users"/>
    <wellKnownID objectClass="text" translateFrom="%Administrators%" translateTo="Administrators"/>
    <wellKnownID objectClass="text" translateFrom="%EnterpriseAdmins%" translateTo="Enterprise Admins"/>
    <wellKnownID objectClass="text" translateFrom="%DomainAdmins%" translateTo="Domain Admins"/>
    <wellKnownID objectClass="text" translateFrom="%SchemaAdmins%" translateTo="Schema Admins"/>
    <wellKnownID objectClass="text" translateFrom="%DnsAdmins%" translateTo="DnsAdmins"/>
    <wellKnownID objectClass="text" translateFrom="%RemoteDesktopUsers%" translateTo="Remote Desktop Users"/>
    <wellKnownID objectClass="text" translateFrom="%domain%" translateTo="EM"/>
    <wellKnownID objectClass="text" translateFrom="%domaindns%" translateTo="em.city"/>
    <wellKnownID objectClass="text" translateFrom="%RootDN%" translateTo="DC=em,DC=city"/>
    <wellKnownID objectClass="text" translateFrom="%Users%" translateTo="Users"/>
    <wellKnownID objectClass="group" translateFrom="%t0-global%" translateTo="L-S-T0"/>
    <wellKnownID objectClass="group" translateFrom="%t1-global%" translateTo="L-S-T1"/>
    <wellKnownID objectClass="group" translateFrom="%t2-global%" translateTo="L-S-T2"/>
    <wellKnownID objectClass="group" translateFrom="%t1l-global%" translateTo="L-S-T1L"/>
    <wellKnownID objectClass="group" translateFrom="%t2l-global%" translateTo="L-S-T2L"/>
    <wellKnownID objectClass="group" translateFrom="%t0-managers%" translateTo="G-S-T0_Managers"/>
    <wellKnownID objectClass="group" translateFrom="%paw-logon%" translateTo="L-S-T0_Paw_Logon"/>
    <wellKnownID objectClass="group" translateFrom="%pawt0-logon%" translateTo="L-S-T0_PawT0_Logon"/>
    <wellKnownID objectClass="group" translateFrom="%pawt12l-logon%" translateTo="L-S-T0_PawT12L_Logon"/>
    <wellKnownID objectClass="group" translateFrom="%t0-localAdmin-servers%" translateTo="L-S-T0_LocalAdmins_Servers"/>
    <wellKnownID objectClass="group" translateFrom="%t0-localAdmin-workstations%" translateTo="L-S-T0_LocalAdmins_Workstations"/>
    <wellKnownID objectClass="group" translateFrom="%t1-managers%" translateTo="G-S-T1_Managers"/>
    <wellKnownID objectClass="group" translateFrom="%t1-administrators%" translateTo="G-S-T1_Administrators"/>
    <wellKnownID objectClass="group" translateFrom="%t1-operators%" translateTo="G-S-T1_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%t1-localAdmin-servers%" translateTo="L-S-T1_LocalAdmins_Servers"/>
    <wellKnownID objectClass="group" translateFrom="%t2-managers%" translateTo="G-S-T2_Managers"/>
    <wellKnownID objectClass="group" translateFrom="%t2-administrators%" translateTo="G-S-T2_Administrators"/>
    <wellKnownID objectClass="group" translateFrom="%t2-operators%" translateTo="G-S-T2_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%t2-localAdmin-workstations%" translateTo="L-S-T2_LocalAdmins_Workstations"/>
    <wellKnownID objectClass="group" translateFrom="%tll-operators%" translateTo="G-S-T1L_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%t2l-operators%" translateTo="G-S-T2L_Operators"/>
    <wellKnownID objectClass="group" translateFrom="%t1l-localAdmin-servers%" translateTo="L-S-TL_LocalAdmins_Servers"/>
    <wellKnownID objectClass="group" translateFrom="%t2l-localAdmin-workstations%" translateTo="L-S-TL_LocalAdmins_Workstations"/>
    <wellKnownID objectClass="group" translateFrom="%T1-LAPS-PasswordReset%" translateTo="L-S-T1-DELEG_LAPS_PwdReset"/>
    <wellKnownID objectClass="group" translateFrom="%T1-LAPS-PasswordReader%" translateTo="L-S-T1-DELEG_LAPS_PwdRead"/>
    <wellKnownID objectClass="group" translateFrom="%T2-LAPS-PasswordReset%" translateTo="L-S-T2-DELEG_LAPS_PwdReset"/>
    <wellKnownID objectClass="group" translateFrom="%T2-LAPS-PasswordReader%" translateTo="L-S-T2-DELEG_LAPS_PwdRead"/>
    <wellKnownID objectClass="group" translateFrom="%Prefix%" translateTo="L-S"/>
    <wellKnownID objectClass="group" translateFrom="%Groups_Computers%" translateTo="LocalAdmins_%ComputerName%"/>

    <wellKnownID objectClass="text" translateFrom="%OU-Administration%" translateTo="Administration"/>

    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T0%" translateTo="GroupsT0"/>
    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T1%" translateTo="GroupsT1"/>
    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T2%" translateTo="GroupsT2"/>
    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T1L%" translateTo="GroupsT1L"/>
    <wellKnownID objectClass="text" translateFrom="%OU-ADM-Groups-T2L%" translateTo="GroupsT2L"/>

    <wellKnownID objectClass="text" translateFrom="%OU-PAW%" translateTo="Paw"/>
    <wellKnownID objectClass="text" translateFrom="%OU-PAW-T0%" translateTo="PawT0"/>
    <wellKnownID objectClass="text" translateFrom="%OU-PAW-T12L%" translateTo="PawT12L"/>

    <wellKnownID objectClass="text" translateFrom="%OU-LocalAdmins%" translateTo="LocalAdmins"/>

    <wellKnownID objectClass="text" translateFrom="%OU-Production-T0%" translateTo="Harden_T0"/>

    <wellKnownID objectClass="text" translateFrom="%OU-Production-T12%" translateTo="Harden_T12"/>
    <wellKnownID objectClass="text" translateFrom="%OU-PRD-T12-Workstations%" translateTo="Workstations"/>
    <wellKnownID objectClass="text" translateFrom="%OU-PRD-T12-Servers%" translateTo="Servers"/>

    <wellKnownID objectClass="text" translateFrom="%OU-Production-TL%" translateTo="Harden_TL"/>


    <Keyword LongName="servers" ShortenName="Srv"/>
    <Keyword LongName="server" ShortenName="Srv"/>
    <Keyword LongName="workstations" ShortenName="Wks"/>
    <Keyword LongName="workstation" ShortenName="Wks"/>
    <Keyword LongName="services" ShortenName="Svc"/>
    <Keyword LongName="service" ShortenName="Svc"/>
    <Keyword LongName="accounts" ShortenName="Acct"/>
    <Keyword LongName="account" ShortenName="Acct"/>
    <Keyword LongName="passwords" ShortenName="Pwd"/>
    <Keyword LongName="password" ShortenName="Pwd"/>
    <Keyword LongName="Firewalls" ShortenName="Fwl"/>
    <Keyword LongName="Firewall" ShortenName="Fwl"/>
    <Keyword LongName="security" ShortenName="Secu"/>
    <Keyword LongName="local" ShortenName="Loc"/>
    <Keyword LongName="administrators" ShortenName="Adm"/>
    <Keyword LongName="administrator" ShortenName="Adm"/>
    <Keyword LongName="Operators" ShortenName="Ope"/>
    <Keyword LongName="Operator" ShortenName="Ope"/>
    <Keyword LongName="Managers" ShortenName="Mgr"/>
    <Keyword LongName="Manager" ShortenName="Mgr"/>
  </Translation>

  <GroupPolicies>
    <!-- ################################################################################################################################# -->
    <!-- The <WmiFilter> section allows the script to import MOF files to the Group Policy WMI Filters Container.                          -->
    <!-- Once a WMI Filter has been imported, it could be attached to a GPO through this script with te <GpoFilter> reference.             -->
    <!-- All MOF files to import must be located in .\Inputs\GroupPolicies\WmiFilters.                                                     -->
    <!-- Name refers to the display name, as shown in the GUI. Source refers to the source mof file to import.                             -->
    <!-- ################################################################################################################################# -->
    <WmiFilters>
      <Filter Name="Windows-All_Legacy_All" Source="Windows-All_Legacy_All.mof"/>
      <Filter Name="Windows-All_Legacy_Members" Source="Windows-All_Legacy_Members.mof"/>
      <Filter Name="Windows-All_Members" Source="Windows-All_Members.mof"/>
      <Filter Name="Windows-All_Supported_All" Source="Windows-All_Supported_All.mof"/>
      <Filter Name="Windows-All_Supported_Members" Source="Windows-All_Supported_Members.mof"/>
      <Filter Name="Windows-Client-7" Source="Windows-Client-7.mof"/>
      <Filter Name="Windows-Client" Source="Windows-Client.mof"/>
      <Filter Name="Windows-Client_10" Source="Windows-Client_10.mof"/>
      <Filter Name="Windows-Client_11" Source="Windows-Client_11.mof"/>
      <Filter Name="Windows-Client_8" Source="Windows-Client_8.mof"/>
      <Filter Name="Windows-Client_Legacy" Source="Windows-Client_Legacy.mof"/>
      <Filter Name="Windows-Client_Supported" Source="Windows-Client_Supported.mof"/>
      <Filter Name="Windows-Client_Vista" Source="Windows-Client_Vista.mof"/>
      <Filter Name="Windows-Client_XP" Source="Windows-Client_XP.mof"/>
      <Filter Name="Windows-Server_2003-2003R2_All" Source="Windows-Server_2003-2003R2_All.mof"/>
      <Filter Name="Windows-Server_2003-2003R2_Members" Source="Windows-Server_2003-2003R2_Members.mof"/>
      <Filter Name="Windows-Server_2008R2_All" Source="Windows-Server_2008R2_All.mof"/>
      <Filter Name="Windows-Server_2008R2_Members" Source="Windows-Server_2008R2_Members.mof"/>
      <Filter Name="Windows-Server_2008_All" Source="Windows-Server_2008_All.mof"/>
      <Filter Name="Windows-Server_2008_Members" Source="Windows-Server_2008_Members.mof"/>
      <Filter Name="Windows-Server_2012R2_All" Source="Windows-Server_2012R2_All.mof"/>
      <Filter Name="Windows-Server_2012R2_Members" Source="Windows-Server_2012R2_Members.mof"/>
      <Filter Name="Windows-Server_2012_All" Source="Windows-Server_2012_All.mof"/>
      <Filter Name="Windows-Server_2012_Members" Source="Windows-Server_2012_Members.mof"/>
      <Filter Name="Windows-Server_2016-and-Newer_All" Source="Windows-Server_2016-and-Newer_All.mof"/>
      <Filter Name="Windows-Server_2016-and-Newer_Members" Source="Windows-Server_2016-and-Newer_Members.mof"/>
      <Filter Name="Windows-Server_2016_All" Source="Windows-Server_2016_All.mof"/>
      <Filter Name="Windows-Server_2016_Members" Source="Windows-Server_2016_Members.mof"/>
      <Filter Name="Windows-Server_2019_All" Source="Windows-Server_2019_All.mof"/>
      <Filter Name="Windows-Server_2019_Members" Source="Windows-Server_2019_Members.mof"/>
      <Filter Name="Windows-Server_2022_All" Source="Windows-Server_2022_All.mof"/>
      <Filter Name="Windows-Server_2022_Members" Source="Windows-Server_2022_Members.mof"/>
      <Filter Name="Windows-Server_All" Source="Windows-Server_All.mof"/>
      <Filter Name="Windows-Server_Legacy_All" Source="Windows-Server_Legacy_All.mof"/>
      <Filter Name="Windows-Server_Legacy_Members" Source="Windows-Server_Legacy_Members.mof"/>
      <Filter Name="Windows-Server_Members" Source="Windows-Server_Members.mof"/>
      <Filter Name="Windows-Server_Supported_All" Source="Windows-Server_Supported_All.mof"/>
      <Filter Name="Windows-Server_Supported_Members" Source="Windows-Server_Supported_Members.mof"/>
    </WmiFilters>

    <!-- ################################################################################################################################# -->
    <!-- The <GPO> elements list the Group Policy added (or refreshed) to the target domain.                                               -->
    <!-- Each of this Group Policy is first generated with no data (if not existing), then data is imported from its backup folder.        -->
    <!--   > BackupID...: refer to the unique ID of the backup folder                                                                      -->
    <!--   > validation.: if set to  No, the GPO is created and overwrited from its backup. Yes will only link the GPO to its targets.     -->
    <!--   > Name.......: refer to the display name, as shown in the GUI                                                                   -->
    <!--   > Description: description label, as shown in the GUI.                                                                          -->
    <!--                                                                                                                                   -->
    <!-- The <GPOMODE> will identify the Tier perimeter (for group management) and mode to be applied.                                     -->
    <!--   > Tier.......: Tier0, Tier1 or Tier2.                                                                                           -->
    <!--   > Mode.......: APPLY, DENY or BOTH. Apply create a group that limit the application scope, whereas DENY enforce the application -->
    <!--                  to everyone except the denied one. BOTH mix the two modes, enforcing application to only a scoped target group   -->
    <!--                  with an exception scope (usefull for migration or testing purpose). If mode is ommited, the mode BOTH will be    -->
    <!--                  used.                                                                                                            -->
    <!--                                                                                                                                   -->
    <!-- The <gpoDeny> ID attribute will set the specified identity with permission "Deny Execute" - you can se as many input as requiered.-->
    <!--   > ID......: use either sAMAccountName, object GUID or SID to identify the target identity to deny.                              -->
    <!--                                                                                                                                   -->
    <!-- The <gpoLink> attribute Will link the GPO to the specified target - you can use as many input as requiered.                       -->
    <!--   > Path....: DistinguishedName of the target OU where the GPO have to be linked. Use "RootDN" to refer to the DN of the domain.  -->
    <!--   > Enabled.: "Yes", "No". Teach the script to enable the link or not.                                                            -->
    <!--   > Enforced: "Yes", "No". Teach the script to enforce this stratagy to any descending GPO that normally overcome its parameters. -->
    <!--                                                                                                                                   -->
    <!-- The <GpoFilter> parameter refers to the WMI filter that should be linked to this GPO.                                             -->
    <!--   > WMI.....: the Display Name of the target WMI filter to be used (you can refer to the name section of the MOF import)          -->
    <!--                                                                                                                                   -->
    <!-- The <GpoSecurityFilter> parameter tasks the script to set "authenticated users" as read only and add a security group as new      -->
    <!-- security filter extension.                                                                                                        -->
    <!-- ################################################################################################################################# -->

    <!-- GPO GROUP SETTINGS: used to generate APPLY and DENY Group Name. Use %tier% to mark the Tier localization in the new name          -->
    <!--   > GpoName..: define the group name for applying or denying a group                                                              -->
    <GlobalGpoSettings GroupName="G-S-%tier%-GPO_%GpoName%_%mode%" Tier0="T0" Tier1="T1" Tier2="T2">
      <GpoTier0 OU="OU=GPO,OU=GroupsT0,OU=Administration,%rootDN%"/>
      <GpoTier1 OU="OU=GPO,OU=GroupsT1,OU=Administration,%rootDN%"/>
      <GpoTier2 OU="OU=GPO,OU=GroupsT2,OU=Administration,%rootDN%"/>
    </GlobalGpoSettings>

    <!-- TEMPLATE
	  <GPO BackupID="{9A9AD00F-56D9-476C-9D65-CEAD0FB31B4F}" Validation="Yes" Name="display name" Description="gpo description">
		<GpoFilter>WmiFilterName</GpoFilter>
		<GpoLink Path="RootDN" Enabled="No" Enforced="No"/>
    </GPO>
	  -->

    <!-- <GPO BackupID="{4D872198-701E-4D42-B7D0-7ADE946DB2C8}" Validation="Yes" Name="HAD_Anonymous-SAM_Blocked" Description="Harden AD ===================
Blocks anonymous access to SAM database.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_2016-and-Newer_All"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO> -->
    <GPO BackupID="{3B8C8687-8779-4042-AFF9-83F88BB4B894}" Validation="Yes" Name="HAD_Auto-Update_S1_Thu_0h_Srv" Description="Harden AD ===================
Scheduling of updates and reboot after 15min of the machine in W1 on Wednesday at 00:00 AM">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_All"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{89B9E68A-F486-4FA3-B336-7B10B22E714A}" Validation="Yes" Name="HAD_Auto-Update_S1_Thu_1h_Srv" Description="Harden AD ===================
Scheduling of updates and reboot after 15min of the machine in W1 on Wednesday at 01:00 AM">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_All"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{7B81D2FF-C69F-4B0C-A91F-DAF6D953555E}" Validation="Yes" Name="HAD_Auto-Update_S3_Thu_0h_Srv" Description="Harden AD ===================
Scheduling of updates and reboot after 15min of the machine in W3 on Wednesday at 00:00 AM">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_All"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{A89FC9A2-EB8E-4E4D-8031-80BF04F5A992}" Validation="Yes" Name="HAD_Auto-Update_S3_Thu_1h_Srv" Description="Harden AD ===================
Scheduling of updates and reboot after 15min of the machine in W3 on Wednesday at 01:00 AM">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_All"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{5B6FA350-D2C7-4A62-A107-3C59017EBAAC}" Validation="Yes" Name="HAD_Auto-Update_S4_Thu_0h_Srv" Description="Harden AD ===================
Scheduling of updates and reboot after 15min of the machine in W4 on Wednesday at 00:00 AM">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_All"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{69D0F16E-B88F-4965-8B1D-1AB6CD1B7C7A}" Validation="Yes" Name="HAD_Auto-Update_S4_Thu_1h_Srv" Description="Harden AD ===================
Scheduling of updates and reboot after 15min of the machine in W4 on Wednesday at 01:00 AM">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_All"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{22589A7C-8042-48FD-95F5-64673EE4BAAA}" Validation="Yes" Name="HAD_Auto-Update_Win10-11" Description="Harden AD ===================
Setting up Windows Update on Windows 10/11 machines according to the recommendations">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{3BE6078C-5B36-4C4A-80BB-C619EA5C98B3}" Validation="Yes" Name="HAD_Auto-Update_Win7-8" Description="Harden AD ===================
Setting up Windows Update on Windows 7/8 machines according to the recommendations">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <!-- <GPO BackupID="{A6799028-B0CE-481D-A536-DDD8FBE4E07E}" Validation="Yes" Name="HAD_Bitlocker-TpmOnly_Win10-11" Description="Harden AD ===================
Enable BitLocker encryption with Trusted Platform Module.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO> -->
    <GPO BackupID="{5DB333BA-3F67-405A-868C-403DF01347A9}" Validation="Yes" Name="HAD_Bitlocker-TpmPin_Win10-11" Description="Harden AD ===================
Enable BitLocker encryption with Trusted Platform Module. 6-digit PIN code required.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{651CC04C-B863-4346-B90F-7D97B42020BC}" Validation="Yes" Name="HAD_BloodHound_Slowed" Description="Harden AD ===================
Disable Net Session enumeration - Bloodhound / NetCease.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{250625BF-21F7-4E43-913A-975994ACB971}" Validation="Yes" Name="HAD_Browser_Disabled" Description="Harden AD ===================
Disable the Windows Browser service.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-All_Legacy_All"/>
      <GpoLink Path="OU=Harden_TL,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{4AA1D324-A28C-4E3D-A356-A9992E1ED1F4}" Validation="Yes" Name="HAD_Camera-on-lockon_Disabled" Description="Harden AD ===================
Blocks the camera on the lock screen.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{43B72F81-55EE-4E7E-890B-7B738677B14A}" Validation="Yes" Name="HAD_DCLocaltor_Configuration" Description="Harden AD ===================
Prevents the DC from generating its DNS entries in _tcp_msdsc.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_Members"/>
      <GpoLink Path="OU=Domain Controllers,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{F9DBA31A-45A6-42A2-B63C-4ED76AC5DB58}" Validation="Yes" Name="HAD_DistributedFileSystem_Disabled" Description="Harden AD ===================
Disable the Windows DFS Namespace service.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=Harden_TL,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{5B274948-774F-4604-96AD-45D2CFDA0015}" Validation="Yes" Name="HAD_FIPS_Enabled" Description="Harden AD ===================
Forces the use of the FIPS algorithm where possible.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{33E571EF-52D9-48BF-9A42-BB2C7ACECD5B}" Validation="Yes" Name="HAD_Firewall_Audit_Only" Description="Harden AD ===================
Setup Microsoft Firewall in audit mode (allow all, log everything).">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{FE6AD3D8-4733-4C25-9006-BB2B2402FD07}" Validation="Yes" Name="HAD_Firewall_Block_Inbound" Description="Harden AD ===================
Setup Microsoft Firewall in active mode in addition to system local rules.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{B2FC1442-08FD-4CDE-AF82-417E0CE1046F}" Validation="Yes" Name="HAD_GPO_Refresh_Cycle" Description="Harden AD ===================
Set the GPO refresh rate to 15 minutes.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{4C100949-4368-407F-B371-A80615D07305}" Validation="Yes" Name="HAD_IPv6_Disabled" Description="Harden AD ===================
Disables IPv6.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{960547AE-574B-4A5E-B238-7A6C0DD491D2}" Validation="Yes" Name="HAD_Kerberos-AES_Enabled" Description="Harden AD ===================
Set the encryption types that Kerberos is allowed to use.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_All"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{614C4CD2-6F10-416C-90C4-BB1AB8703FA1}" Validation="Yes" Name="HAD_LAPS_Configuration" Description="Harden AD ===================
Configuration of the LAPS utility.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-All_Members"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{6D104481-B9FC-4ABD-ACD0-CAB7BE59833E}" Validation="Yes" Name="HAD_LAPS_X64_Deployment" Description="Harden AD ===================
Deployment of the LAPS utility for 64bit systems.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{BAC83533-881C-427B-BDB8-A70526A84ADD}" Validation="Yes" Name="HAD_LAPS_X86_Deployment" Description="Harden AD ===================
Deployment of the LAPS utility for 32bit systems.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{FA2ECE42-130C-4E79-A30A-CF4B5567C5FA}" Validation="Yes" Name="HAD_LDAP_Audit_Enabled" Description="Harden AD ===================
Enable event logs for the LDAP protocol.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_All"/>
      <GpoLink Path="OU=Domain Controllers,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{CA093B03-5505-4704-B673-EA94ED4F8994}" Validation="Yes" Name="HAD_LDAP_CBT_Enabled" Description="Harden AD ===================
Enforces validation of Channel Binding Tokens (CBT) received in LDAP bind requests.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{26CD251A-3354-44D5-94E4-30D0B854A3F3}" Validation="Yes" Name="HAD_LDAP_Client-Signing_Not_Required" Description="Harden AD ===================
Does not require a signature for LDAP communications with a client.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{47A91C4D-D50A-4C35-9AE3-DFF1DB8299E4}" Validation="Yes" Name="HAD_LDAP_Client-Signing_Required" Description="Harden AD ===================
Requires signing for LDAP communications with a client.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{DA84E960-529F-4580-A16A-E8C73CCE27F0}" Validation="Yes" Name="HAD_LDAP_Server-Signing_Required" Description="Harden AD ===================
Requires signing for LDAP communications with a server.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{5FCEADFE-DFF0-40E7-BDA1-D49DC3EB5655}" Validation="Yes" Name="HAD_LLMNR_Disabled" Description="Harden AD ===================
Disables Link-local Multicast Name Resolution (LLMNR).">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{E26B2FB8-9251-45D2-99ED-0B643A0759DB}" Validation="Yes" Name="HAD_LMHASH_Disabled" Description="Harden AD ===================
Disables LMHASH.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{2778E818-F47E-4A4C-B2EE-708C5A870FDC}" Validation="Yes" Name="HAD_LocalAdmins_Paw" Description="Harden AD ===================
Add the local administration AD group to the corresponding PAW's integrated administrator group">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=Paw,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{F4080F7A-83AD-4A81-A127-C94C69F14D08}" Validation="Yes" Name="HAD_LocalAdmins_PawT0" Description="Harden AD ===================
Add the local administration AD group to the corresponding T0 PAW's integrated administrator group">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=PawT0,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{25682D74-5A17-4589-A19C-C14704ECFA42}" Validation="Yes" Name="HAD_LocalAdmins_PawT12L" Description="Harden AD ===================
Add the local administration AD group to the corresponding T12L PAW's integrated administrator group">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=PawT12L,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>

    <GPO BackupID="{B9A42D3A-61F4-45D4-BF94-D61B80570838}" Validation="Yes" Name="HAD_LocalAdmins_T0-Srv" Description="Harden AD ===================
Add the local administration AD group to the corresponding T0 system's integrated administrator group">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_Supported_Members"/>
      <GpoLink Path="OU=Harden_T0,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{F9EF6561-3ED3-4990-AB9B-E53CCC855B94}" Validation="Yes" Name="HAD_LocalAdmins_T0-Wks" Description="Harden AD ===================
Add the local administration AD group to the corresponding T0 system's integrated administrator group">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client_Supported"/>
      <GpoLink Path="OU=Harden_T0,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{9B52CEFC-64E9-43EF-A822-DA5557416251}" Validation="Yes" Name="HAD_LocalAdmins_T1" Description="Harden AD ===================
Add the local administration AD group to the corresponding T1 system's integrated administrator group">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_Supported_Members"/>
      <GpoLink Path="OU=Servers,OU=Harden_T12,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{4B947060-F817-414E-B27B-DC7EFF171B6B}" Validation="Yes" Name="HAD_LocalAdmins_T1L" Description="Harden AD ===================
Add the local administration AD group to the corresponding legacy server (T1L) system's integrated administrator group">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_Legacy_Members"/>
      <GpoLink Path="OU=Servers,OU=Harden_TL,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{DBB5A54A-4338-4D59-A25E-BD71CEBB86B2}" Validation="Yes" Name="HAD_LocalAdmins_T2" Description="Harden AD ===================
Add the local administration AD group to the corresponding T2 system's integrated administrator group">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client_Supported"/>
      <GpoLink Path="OU=Workstations,OU=Harden_T12,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{F6D93646-E7DB-49C1-9FDC-9B0840C54637}" Validation="Yes" Name="HAD_LocalAdmins_T2L" Description="Harden AD ===================
Add the local administration AD group to the corresponding legacy workstation (T2L) system's integrated administrator group">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client_Legacy"/>
      <GpoLink Path="OU=Workstations,OU=Harden_TL,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{4D5DF38A-161D-42AD-A29B-94309EDE3D0D}" Validation="Yes" Name="HAD_Local_Accounts_Config" Description="Harden AD ===================
Enable and rename the local administrator account.
Disable and rename the local guest account.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
      <GpoLink Path="OU=Harden_T0,RootDN" Enabled="Yes" Enforced="Yes"/>
      <GpoLink Path="OU=Harden_T12,RootDN" Enabled="Yes" Enforced="Yes"/>
      <GpoLink Path="HardenTL,RootDN" Enabled="Yes" Enforced="Yes"/>
      <GpoLink Path="OU=Computers,OU=Provisioning,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{23B70F22-A8A7-4CED-8E3C-632B793E909A}" Validation="Yes" Name="HAD_LoginRestrictions_Paw" Description="Harden AD ===================
Restrict connections to administration stations">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=Paw,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{6405F191-E007-4CC5-A05D-14EE8FC2F1C5}" Validation="Yes" Name="HAD_LoginRestrictions_PawT0" Description="Harden AD ===================
Restrict connections to tier 0 administration stations">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=PawT0,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{CA0E80E7-B301-4BB9-A17C-B83BB21CD096}" Validation="Yes" Name="HAD_LoginRestrictions_PawT12L" Description="Harden AD ===================
Restrict connections to legacy administration stations">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=PawT12L,OU=Administration,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{4BA71A2D-121D-4C23-82DC-B11895DD53CD}" Validation="Yes" Name="HAD_LoginRestrictions_T0" Description="Harden AD ===================
Blocks connections to tier 0 machines from other tier accounts">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=Harden_T0,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{35A1EE98-40C1-4A4E-8C31-CA376AD1E34E}" Validation="Yes" Name="HAD_LoginRestrictions_T1" Description="Harden AD ===================
Blocks connections to tier 1 machines from other tier accounts">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_Supported_Members"/>
      <GpoLink Path="OU=Servers,OU=Harden_T12,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{DA57EB62-4947-4D5B-B2B8-C46DEEDE846B}" Validation="Yes" Name="HAD_LoginRestrictions_T1L" Description="Harden AD ===================
Blocks connections to tier legacy servers from other tier accounts">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_Legacy_Members"/>
      <GpoLink Path="OU=Servers,OU=Harden_TL,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{F074C00D-D8D6-48F9-A2F8-51F932C70D46}" Validation="Yes" Name="HAD_LoginRestrictions_T2" Description="Harden AD ===================
Blocks connections to tier 2 machines from other tier accounts">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client_Supported"/>
      <GpoLink Path="OU=Workstations,OU=Harden_T12,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{61FA8970-A5E5-40C5-9726-CBB85CE7B12D}" Validation="Yes" Name="HAD_LoginRestrictions_T2L" Description="Harden AD ===================
Blocks connections to tier legacy workstations from other tier accounts">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client_Legacy"/>
      <GpoLink Path="OU=Workstations,OU=Harden_TL,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{38C8D47E-E4F2-4DF2-8B60-BE9B3E53647D}" Validation="Yes" Name="HAD_Logon-Cache_0" Description="Harden AD ===================
No login credentials cached from servers.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{BC9F44A0-7603-4223-AD48-9467B675086F}" Validation="Yes" Name="HAD_Logon-Cache_2" Description="Harden AD ===================
Keeps two login credentials cached from servers.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{41D3950E-ACD2-4CD8-99B5-DE791765C727}" Validation="Yes" Name="HAD_MSLive-Accounts_Disabled" Description="Harden AD ===================
Blocks the use of personal Microsoft accounts.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{CBC80F59-C833-4D33-AC3A-4AA9F96822EB}" Validation="Yes" Name="HAD_NBT-NS_Disabled" Description="Harden AD ===================
Disables DNS Fallback functionality: NBT-NS.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{5B9C9897-9806-4996-A3E6-10403FD271ED}" Validation="Yes" Name="HAD_NTLM1_LMx_Disabled" Description="Harden AD ===================
Forces the use of NTLMv2 response. LM and NTLMv1 responses are refused.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{FC218E07-367D-413B-8114-F6810F8956E4}" Validation="Yes" Name="HAD_NTLMv2_128bits_Enabled" Description="Harden AD ===================
Configure NTLMv2 to use 128-bit encryption.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{0B5A54A5-92DB-4405-AE69-CB2154F4E613}" Validation="Yes" Name="HAD_PageFile_Shutdown_Cleared" Description="Harden AD ===================
Empty the pagefile.sys on each shutdown.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{64A1C268-27C7-4343-B236-9E3BF2862578}" Validation="Yes" Name="HAD_PowerShell_Logs" Description="Harden AD ===================
Enable Logs for PowerShell.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{993763F7-7500-4F90-89F7-52EF29307A2E}" Validation="Yes" Name="HAD_Print-Spooler_Disabled" Description="Harden AD ===================
Disables the print spooler service on windows system.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Server_All"/>
      <GpoLink Path="OU=Harden_T0,RootDN" Enabled="Yes" Enforced="Yes"/>
      <GpoLink Path="OU=Domain Controllers,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{3A10AD30-D95C-42C4-AD45-C7E4CBFC2F2D}" Validation="Yes" Name="HAD_RDP_Disabled" Description="Harden AD ===================
Disables the RDP service and prohibits RDP connections">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=Harden_TL,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{1BB7DBE3-5BDB-4959-AC11-5577497A0207}" Validation="Yes" Name="HAD_RDP_Enabled" Description="Harden AD ===================
Enable the RDP service, set the firewall and allow RDP connections">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{6C86197E-8498-4E48-835B-054F00CA1EA3}" Validation="Yes" Name="HAD_RDP_NLA_Enabled" Description="Harden AD ===================
Enable NLA for RDP connections.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{A10BD6F3-E157-46B1-AA07-D3ED1BC764BD}" Validation="Yes" Name="HAD_Remote-Assistance_Disabled" Description="Harden AD ===================
Disable Windows remote assistance.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{393E2FCB-5EDC-4E30-B82C-2B125193B550}" Validation="Yes" Name="HAD_Screenlock_Enabled" Description="Harden AD ===================
Lock inactive sessions after 20 minutes.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{6D9CD91B-F046-41C4-8BC1-4001459D3890}" Validation="Yes" Name="HAD_Secure_NetLogon" Description="Harden AD ===================
Secure Netlogon service.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{11947EF3-D542-4811-A6AC-9F28E79B36D7}" Validation="Yes" Name="HAD_Security_Logs" Description="Harden AD ===================
Configures security logs based on ANSSI recommendations.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{25F951CC-245B-4CB6-8138-F9F38CD3CB78}" Validation="Yes" Name="HAD_Smart-Card_Required" Description="Harden AD ===================
Force the use of Windows Hello for smartcards.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{6930963C-6F98-4496-93B9-09511AF49681}" Validation="Yes" Name="HAD_SMB-Signing_Configuration" Description="Harden AD ===================
Configure SMB signing for clients.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{B4AF8F37-E7BA-4E16-AF25-6C7564EDF406}" Validation="Yes" Name="HAD_SMB1_Audit_Enabled" Description="Harden AD ===================
Creates a scheduled task to audit SMBv1.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{45B3EF38-6E65-4D24-95A8-52A30E3E3F75}" Validation="Yes" Name="HAD_SMB1_Client-Only_Enabled" Description="Harden AD ===================
Enables SMBv1 only for clients.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{8C92A3AD-2312-44C1-A8B3-AD5DDAACEAE1}" Validation="Yes" Name="HAD_SMB1_Disabled" Description="Harden AD ===================
Disables SMBv1.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{85793457-0274-4E62-BFFE-E8655F134CCF}" Validation="Yes" Name="HAD_SMB1_Enabled" Description="Harden AD ===================
Enables SMBv1.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{B43B802B-A6B7-4A22-BF29-6F4AEAD80E91}" Validation="Yes" Name="HAD_SMB1_Server-Only_Enabled" Description="Harden AD ===================
Enables SMBv1 only for servers.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{181A6227-DC22-4E7C-8EAE-DAC9DC2F43AD}" Validation="Yes" Name="HAD_SSL2_SSL3_Disabled" Description="Harden AD ===================
Disables SSLv2 and SSLv3 on Windows systems.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{A78B3D48-38AD-45E1-AF56-E8956D6A0133}" Validation="Yes" Name="HAD_TS_Local-admins-groups" Description="Harden AD ===================
Disables SSLv2 and SSLv3 on Windows systems.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="OU=Domain Controllers,RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{E8BF7E49-1AB8-430E-A215-E36E83FFD59F}" Validation="Yes" Name="HAD_UAC_Enabled" Description="Harden AD ===================
Enables UAC's approval mode for all administrators.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{C1E0AA24-E741-429C-A7C6-DE7577079C87}" Validation="Yes" Name="HAD_WDigest_Disabled" Description="Harden AD ===================
Disables WDigest protocol.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{5E8614C4-055C-48F4-B2DB-639997ECAE42}" Validation="Yes" Name="HAD_Windows-Defender_Config" Description="Harden AD ===================
Configures Windows Defender.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
    <GPO BackupID="{9B819B43-927F-4C12-BCBA-6264DB932E11}" Validation="Yes" Name="HAD_Windows11-Update_Blocked" Description="Harden AD ===================
Blocks the upgrade to Windows 11.">
      <GpoMode Mode="BOTH" Tier="Tier0"/>
      <GpoFilter WMI="Windows-Client"/>
      <GpoLink Path="RootDN" Enabled="Yes" Enforced="Yes"/>
    </GPO>
  </GroupPolicies>

  <Accounts>
    <!-- ################################################################################################################################### -->
    <!-- The <Account> Section list all user identities to be generated by the script.                                                       -->
    <!-- The script first check if the account is already present in the domain (if so, nothing is done), and if not, it will generatae it.  -->
    <!-- The newly created user is then stored with its random password in a keepass file (.\Outputs\HardenAD.kbdx).                         -->
    <!-- Each account is provided with the following input:                                                                                  -->
    <!--   > GivenName.....: the given name of the account                                                                                   -->
    <!--   > Surname.......: the surname of the account                                                                                      -->
    <!--   > sAMAccountName: the sAMAccountName of the account                                                                               -->
    <!--   > displayName...: the name displayed by the GUI                                                                                   -->
    <!--   > Description...: the description of the account                                                                                  -->
    <!--   > Path..........: the distingsuihedName of the OU containing the account. you can use ROOTDN to refer to the domain DN            -->
    <!-- ################################################################################################################################### -->
    <!-- Tier 0 accounts - Manager -->
    <User DisplayName="Admin Harden (T0M)" Surname="HARDEN" samAccountName="T0M-AHARDEN" GivenName="Admin" Description="Admin Harden (Tier 0 Manager)" Path="OU=UsersT0,OU=Administration,ROOTDN"/>
    <!-- Tier 0 accounts - Operators -->
    <User DisplayName="Admin Harden (T0O)" Surname="HARDEN" samAccountName="T0O-AHARDEN" GivenName="Admin" Description="Admin Harden (Tier 0 Operators)" Path="OU=UsersT0,OU=Administration,ROOTDN"/>
    <!--  Tier 1 accounts - Managers  -->
    <User DisplayName="Admin Harden (T1M)" Surname="HARDEN" samAccountName="T1M-AHARDEN" GivenName="Admin" Description="Admin Harden (Tier 1 Manager)" Path="OU=UsersT1,OU=Administration,ROOTDN"/>
    <!--  Tier 1 accounts - Administrators  -->
    <User DisplayName="Admin Harden (T1A)" Surname="HARDEN" samAccountName="T1A-AHARDEN" GivenName="Admin" Description="Admin HARDEN (Tier 1 Administrator)" Path="OU=UsersT1,OU=Administration,ROOTDN"/>
    <!--  Tier 1 accounts - Operators  -->
    <User DisplayName="Admin HARDEN (T1O)" Surname="HARDEN" samAccountName="T1O-AHARDEN" GivenName="Admin" Description="Admin HARDEN (Tier 0 Operator)" Path="OU=UsersT1,OU=Administration,ROOTDN"/>
    <!--  Tier 2 accounts - Managers  -->
    <User DisplayName="Admin HARDEN (T2M)" Surname="HARDEN" samAccountName="T2M-AHARDEN" GivenName="Admin" Description="Admin HARDEN (Tier 2 Manager)" Path="OU=UsersT2,OU=Administration,ROOTDN"/>
    <!--  Tier 2 accounts - Administrators  -->
    <User DisplayName="Admin HARDEN (T2A)" Surname="HARDEN" samAccountName="T2A-AHARDEN" GivenName="Admin" Description="Admin HARDEN (Tier 2 Adminstrator)" Path="OU=UsersT2,OU=Administration,ROOTDN"/>
    <!--  Tier 2 accounts - Operators  -->
    <User DisplayName="Admin HARDEN (T2O)" Surname="HARDEN" samAccountName="T2O-AHARDEN" GivenName="Admin" Description="Admin HARDEN (Tier 2 Operator)" Path="OU=UsersT2,OU=Administration,ROOTDN"/>
    <!--  Tier 1 Legacy accounts - Operators  -->
    <User DisplayName="Admin HARDEN (T1LO)" Surname="HARDEN" samAccountName="T1LO-AHARDEN" GivenName="Admin" Description="Admin HARDEN (Tier 1 Legacy Operator)" Path="OU=UsersT1L,OU=Administration,ROOTDN"/>
    <!--  Tier 2 Legacy accounts - Operators  -->
    <User DisplayName="Admin HARDEN (T2LO)" Surname="HARDEN" samAccountName="T2LO-AHARDEN" GivenName="Admin" Description="Admin HARDEN (Tier 2 Legacy Operator)" Path="OU=UsersT2L,OU=Administration,ROOTDN"/>
  </Accounts>

  <Groups>
    <!-- ################################################################################################################################### -->
    <!-- The <Groups> Section list all group identities to be generated by the script.                                                       -->
    <!-- The script first check if the group is already present in the domain (if so, nothing is done), and if not, it will generatae it.    -->
    <!-- Each group is provided with the following input:                                                                                    -->
    <!--   > Name..........: the name of the group, also its display name and sAMAccountName                                                 -->
    <!--   > Description...: the description of the group                                                                                    -->
    <!--   > Scope.........: domainLocal, Local, Global or Universal                                                                         -->
    <!--   > Category......: security or distribution                                                                                        -->
    <!--                                                                                                                                     -->
    <!-- In a second time, all groups are populated with the <member> input.                                                                 -->
    <!--   > sAMAccountName: the sAMAccountName of the target member.                                                                        -->
    <!-- ################################################################################################################################### -->

    <!-- #### TIER 0 #### -->

    <Group name="L-S-T0_LocalAdmins_Servers" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=LocalAdmins,OU=GroupsT0,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T0_LocalAdmins_Workstations" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=LocalAdmins,OU=GroupsT0,OU=Administration,ROOTDN">
    </Group>

    <Group name="G-S-T0_Managers" Category="Security" Scope="Global" Description="Members of this group can see and manage all the Active Directory objects" Path="OU=GroupsT0,OU=Administration,ROOTDN">
      <Member samAccountName="T0M-AHARDEN"/>
    </Group>

    <Group name="G-S-T0_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier 0 resources (login)" Path="OU=GroupsT0,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T0" Category="Security" Scope="domainLocal" Description="Members of this group are part of Tier 0 administrative assets" Path="OU=GroupsT0,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T0_Managers"/>
      <Member samAccountName="G-S-T0_Operators"/>
    </Group>

    <Group name="L-S-T0_Paw_Logon" Category="Security" Scope="domainLocal" Description="Members of this group will be able to connect to the first level administration stations" Path="OU=Logon,OU=GroupsT0,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T0_PawT0_Logon" Category="Security" Scope="domainLocal" Description="Members of this group will be able to connect to the T0 administration stations" Path="OU=Logon,OU=GroupsT0,OU=Administration,ROOTDN">
      <Member samAccountName="L-S-T0"/>
    </Group>

    <Group name="L-S-T0_PawT12L_Logon" Category="Security" Scope="domainLocal" Description="Members of this group will be able to connect to the T1, T2 and TLegacy administration stations" Path="OU=Logon,OU=GroupsT0,OU=Administration,ROOTDN">
    </Group>

    <!-- #### TIER 1 #### -->



    <Group name="G-S-T1_Managers" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 1 ressources, including T1 admin users and groups" Path="OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="T1M-AHARDEN"/>
    </Group>

    <Group name="G-S-T1_Administrators" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 1 resources, excluding T1 admin users and groups" Path="OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="T1A-AHARDEN"/>
    </Group>

    <Group name="G-S-T1_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier 1 resources (login)" Path="OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="T1O-AHARDEN"/>
    </Group>

    <Group name="L-S-T1-DELEG_Group - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_Group - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within Tier 1 Administration OU" Path="OU=Deleg,OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_User - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_User - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within Tier 1 administration OU" Path="OU=Deleg,OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1-DELEG_Computer - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete computers within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Managers"/>
    </Group>

    <Group name="L-S-T1_LocalAdmins_Servers" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=LocalAdmins,OU=GroupsT1,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T1-DELEG_LAPS_PwdRead" Category="Security" Scope="domainLocal" Description="Members of this group will be able to read LAPS password for workstations" Path="OU=Deleg,OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Operators"/>
    </Group>

    <Group name="L-S-T1-DELEG_LAPS_PwdReset" Category="Security" Scope="domainLocal" Description="Members of this group will be able to reset LAPS password for workstations" Path="OU=Deleg,OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Operators"/>
    </Group>

    <Group name="L-S-T1" Category="Security" Scope="domainLocal" Description="Members of this group are part of Tier 1 administrative assets" Path="OU=GroupsT1,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1_Managers"/>
      <Member samAccountName="G-S-T1_Administrators"/>
      <Member samAccountName="G-S-T1_Operators"/>
    </Group>


    <!-- #### TIER 2 #### -->

    <Group name="G-S-T2_Managers" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 2 ressources, including T1 admin users and groups" Path="OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="T2M-AHARDEN"/>
    </Group>

    <Group name="G-S-T2_Administrators" Category="Security" Scope="Global" Description="Members of this group can manage all Tier 2 ressources, excluding T1 admin users and groups" Path="OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="T2A-AHARDEN"/>
    </Group>

    <Group name="G-S-T2_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier 2 resources (login)" Path="OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="T2O-AHARDEN"/>
    </Group>

    <Group name="L-S-T2-DELEG_Group - Manage Membership" Category="Security" Scope="domainLocal" Description="Members of this group can add and remove members of tier 1 groups within productions OUs" Path="OU=Deleg,OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_Group - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete groups within Tier 1 Administration OU" Path="OU=Deleg,OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_User - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_User - Create and Delete (administration)" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete users within Tier 1 administration OU" Path="OU=Deleg,OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_Computer - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete computers within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2-DELEG_Contact - Create and Delete" Category="Security" Scope="domainLocal" Description="Members of this group can create, update and delete contact within productions OUs (Tier 1 and 2)" Path="OU=Deleg,OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Managers"/>
    </Group>

    <Group name="L-S-T2_LocalAdmins_Workstations" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=LocalAdmins,OU=GroupsT2,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T2-DELEG_LAPS_PwdRead" Category="Security" Scope="domainLocal" Description="Members of this group will be able to read LAPS password for workstations" Path="OU=Deleg,OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Operators"/>
    </Group>

    <Group name="L-S-T2-DELEG_LAPS_PwdReset" Category="Security" Scope="domainLocal" Description="Members of this group will be able to reset LAPS password for workstations" Path="OU=Deleg,OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Operators"/>
    </Group>

    <Group name="L-S-T2" Category="Security" Scope="domainLocal" Description="Members of this group are part of Tier 2 administrative assets" Path="OU=GroupsT2,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2_Managers"/>
      <Member samAccountName="G-S-T2_Administrators"/>
      <Member samAccountName="G-S-T2_Operators"/>
    </Group>

    <!-- #### TIER LEGACY #### -->
    <Group name="G-S-T1L_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier Legacy server resources (login)" Path="OU=GroupsT1L,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T1L" Category="Security" Scope="domainLocal" Description="Members of this group are part of Legacy servers' administrative assets" Path="OU=GroupsT1L,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T1L_Operators"/>
    </Group>

    <Group name="L-S-T1L_LocalAdmins_Servers" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=LocalAdmins,OU=GroupsT1L,OU=Administration,ROOTDN">
    </Group>

    <Group name="G-S-T2L_Operators" Category="Security" Scope="Global" Description="Members of this group can operate on Tier Legacy resources (login)" Path="OU=GroupsT2L,OU=Administration,ROOTDN">
    </Group>

    <Group name="L-S-T2L" Category="Security" Scope="domainLocal" Description="Members of this group are part of Legacy servers' administrative assets" Path="OU=GroupsT2L,OU=Administration,ROOTDN">
      <Member samAccountName="G-S-T2L_Operators"/>
    </Group>

    <Group name="L-S-T2L_LocalAdmins_Workstations" Category="Security" Scope="domainLocal" Description="Members of this group will become member of the builtin\administrators group" Path="OU=LocalAdmins,OU=GroupsT2L,OU=Administration,ROOTDN">
    </Group>
  </Groups>

  <DefaultMembers>
    <!-- ################################################################################################################################### -->
    <!-- The <DefaultMembers> Section list strictely allowed members of a specified group.                                                   -->
    <!-- When the script call the function "Reset-GroupMembership", the function will use this data to leave only mandatory identity.        -->
    <!--   > Member: either a SID or a sAMAccountName. Use %domainSID% to dynamically replace it by the domain SID.                          -->
    <!-- ################################################################################################################################### -->
    <!-- Builtin\Administrators -->
    <Group Target="S-1-5-32-544">
      <Member>%DomainSID%-500</Member>
      <Member>%DomainSID%-512</Member>
      <Member>%DomainSID%-519</Member>
    </Group>
    <!-- Domain Admins -->
    <Group Target="%DomainSID%-512">
      <Member>%DomainSID%-500</Member>
    </Group>
    <!-- Enterprise Admins -->
    <Group Target="%DomainSID%-519">
      <Member>%t0-Managers%</Member>
    </Group>
    <!-- Protected Users -->
    <Group Target="%DomainSID%-525">
      <Member>%t0-managers%</Member>
    </Group>
  </DefaultMembers>

  <TaskSchedules BaseDir="C:\_ADM\TasksSchedulesScripts">
    <!-- ################################################################################################################################### -->
    <!-- the <TaskSchedules> section define the sched. tasks to add to the running system and is called by the function New-ScheduleTasks.   -->
    <!-- The following parameters are expected:                                                                                              -->
    <!--   > Name......: The scheduled tasks name, as shown in the GUI.                                                                      -->
    <!--   > Xml.......: The xml file containing a backup of the new scheduled tasks and located in .\Inputs\ScheduleTasks\TasksSchedulesXml -->
    <!--   > SchedCmd..: The executable to be used. It will replace the %command% in the xml file.                                           -->
    <!--   > SchedArg..: The arguments line to pass to the executable. If a script is specified, it should present in                        -->
    <!--                 .\Inputs\ScheduleTasks\TasksSchedulesScripts                                                                        -->
    <!--   > SchedDir..: The effective path context when the schedule is run - use %BaseDir% to refer to the directory value speciefied in   -->
    <!--                 the "BaseDir" parameters of the section <TaskSchedules> (this one, yup).                                            -->
    <!--   > SchedDsc..: The description field for this task.                                                                                -->
    <!--   > SchedPth..: The folder name where the task will be stored in the Tasks Scheduler console.                                       -->
    <!-- ################################################################################################################################### -->
    <!-- flushing Sensible groups with MCS-GroupsFlushing.ps1 -->
    <SchedTask Name="MCS - Sensitive Groups Flushing" Xml="MCS-GroupsFlushing.xml">
      <SchedCmd>powershell.exe</SchedCmd>
      <SchedArg>-windowstyle hidden -file .\MCS-GroupsFlushing.ps1</SchedArg>
      <SchedDir>%BaseDir%\MCS-GroupsFlushing</SchedDir>
      <SchedDsc>Flush highly sensitive groups (see MCS-GroupsScheduling.csv for details)</SchedDsc>
      <SchedPth>HardenAD</SchedPth>
    </SchedTask>
  </TaskSchedules>

  <LocalAdminPasswordSolution>
    <!-- ################################################################################################################################### -->
    <!-- The <LocalAdminPasswordSolution> is used to setup LAPS over an existing domain. 													 -->
    <!-- By default, the model delegate permission to Tier 1 for servers and Tier 2 for workstations. All others are handled by Dom admins.  -->
    <!--                                                                                                                                     -->
    <!-- SelfPermission: Add Write Permission to ms-Mcs-AdmPwdExiprationTime and ms-Mcs-AdmPwd attribute to SELF (i.e. the computer object). -->
    <!-- PasswordReader: Offer the ability to read ms-Mcs-AdmPwd which contains the local user password                                      -->
    <!-- PasswordReset.: Offer the ability to read and write ms-Mcs-AdmPwdExiprationTime and ms-Mcs-AdmPwd attribute						 -->
    <!--                                                                                                                                     -->
    <!-- The script now handles dynamic group mapping and will look at the <Translation> section of this document.							 -->
    <!--                                                                                                                                     -->
    <!-- <AdmPwdSelfPermission>:                                                                                                             -->
    <!--    Target: target OU distinguished name with computer objects. use "RootDN" to dynamically specify the domain distanguished name.   -->
    <!--                                                                                                                                     -->
    <!-- <AdmPwdPasswordreader>:                                                                                                             -->
    <!--    Target: target OU distinguished name with computer objects. use "RootDN" to dynamically specify the domain distanguished name.   -->
    <!--    Id....: Specific the group sAMAccountName to be granted with the password read permission on the target OU.                      -->
    <!--                                                                                                                                     -->
    <!-- <AdmPwdPasswordreset>:                                                                                                              -->
    <!--    Target: target OU distinguished name with computer objects. use "RootDN" to dynamically specify the domain distanguished name.   -->
    <!--    Id....: Specific the group sAMAccountName to be granted with the password reset permission on the target OU.                     -->
    <!-- ################################################################################################################################### -->
    <AdmPwdSelfPermission Target="OU=Servers,OU=Redstone_TLegacy,%RootDN%"/>
    <AdmPwdSelfPermission Target="OU=Servers,OU=Redstone_T12,%RootDN%"/>
    <AdmPwdSelfPermission Target="OU=Workstations,OU=Redstone_TLegacy,%RootDN%"/>
    <AdmPwdSelfPermission Target="OU=Workstations,OU=Redstone_T12,%RootDN%"/>
    <AdmPwdSelfPermission Target="OU=PAW Tier 0,OU=Administration,%RootDN%"/>
    <AdmPwdSelfPermission Target="OU=PAW Tier 1,OU=Administration,%RootDN%"/>
    <AdmPwdSelfPermission Target="OU=PAW Tier 2,OU=Administration,%RootDN%"/>
    <AdmPwdSelfPermission Target="OU=PAW Tier Legacy,OU=Administration,%RootDN%"/>

    <AdmPwdPasswordReader Target="OU=Servers,OU=Redstone_TLegacy,%RootDN%" Id="%domain%\%T1-LAPS-PasswordReader%"/>
    <AdmPwdPasswordReader Target="OU=Servers,OU=Redstone_T12,%RootDN%" Id="%domain%\%T1-LAPS-PasswordReader%"/>
    <AdmPwdPasswordReader Target="OU=Workstations,OU=Redstone_TLegacy,%RootDN%" Id="%domain%\%T2-LAPS-PasswordReader%"/>
    <AdmPwdPasswordReader Target="OU=Workstations,OU=Redstone_T12,%RootDN%" Id="%domain%\%T2-LAPS-PasswordReader%"/>

    <AdmPwdPasswordReset Target="OU=Servers,OU=Redstone_TLegacy,%RootDN%" Id="%domain%\%T1-LAPS-PasswordReset%"/>
    <AdmPwdPasswordReset Target="OU=Servers,OU=Redstone_T12,%RootDN%" Id="%domain%\%T1-LAPS-PasswordReset%"/>
    <AdmPwdPasswordReset Target="OU=Workstations,OU=Redstone_TLegacy,%RootDN%" Id="%domain%\%T2-LAPS-PasswordReset%"/>
    <AdmPwdPasswordReset Target="OU=Workstations,OU=Redstone_T12,%RootDN%" Id="%domain%\%T2-LAPS-PasswordReset%"/>
  </LocalAdminPasswordSolution>

  <Sequence>
    <!-- ################################################################################################################################### -->
    <!-- the <Sequence> section define the different tasks to iterate in "sequence" (can't resist to this one).                              -->
    <!-- To deal with highlight color in display, use the ` to initiate and end a color change in your string, then use one of the three     -->
    <!-- characters specified in value AltBaseHTxt(A,B, or C) to select your color: the color will switch back to normal at the next `.      -->
    <!--			                                                                                                                               -->
    <!-- The default highlight values are those one:                                                                                         -->
    <!--   > `[my text` : magenta                                                                                                            -->
    <!--   > `(my text` : yellow                                                                                                             -->
    <!--   > `{my text` : gray                                                                                                               -->
    <!--			                                                                                                                               -->
    <!-- Some special inputs are usefull to replace value dynamically :                                                                   	 -->
    <!--	 > FileName   : replace with the value of this file                                                                                -->
    <!--	 > RootDN     : replace with domain root DN                                                                                        -->
    <!--			                                                                                                                               -->
    <!-- Each task ID is executed in sequence, based on the Number vaue (ascending). Each Task ID use the following attributes:              -->
    <!--   > Number         : Define the squence order, the lowest will be run first.                                                        -->
    <!--   > Name           : ID task name as refered in the final log output.                                                               -->
    <!--   > CallingFunction: Name of the function to be called from one of the .psm1 files present in the modules directory.                -->
    <!--   > UseParameters  : Mandatory (but could be empty). Specify parameter to pass as argument to CallingFunction.                      -->
    <!--                      Use on per parameter and sort them in sequence (your script should refer them using input ordering).           -->
    <!--   > TaskEnabled    : YES or NO. When set to NO, the tasks is disabled and will not be applied.                                      -->
    <!-- ################################################################################################################################### -->

    <!-- Upgrade Domain Functional Level                                                                                                    -->
    <Id Number="005" Name="Upgrade Domain Functional Level">
      <CallingFunction>Set-ADFunctionalLevel</CallingFunction>
      <!--Parameter: Specify Upgrade is applied to Domain (and not Forest)                                                                   -->
      <UseParameters>Domain</UseParameters>
      <!--Parameter: Target Functional Level. Possibe values: "2008R2","2012","2012R2","2016","Last"                                         -->
      <UseParameters>Last</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Upgrade `(DomainFunctionalLevel` </TaskDescription>
    </Id>

    <!-- Upgrade Forest Functional Level                                                                                                     -->
    <Id Number="006" Name="Upgrade Forest Functional Level">
      <CallingFunction>Set-ADFunctionalLevel</CallingFunction>
      <!--Parameter: Specify Upgrade is applied to Domain (and not Forest)                                                                   -->
      <UseParameters>Forest</UseParameters>
      <!--Parameter: Target Functional Level. Possibe values: "2008R2","2012","2012R2","2016","Last"                                         -->
      <UseParameters>Last</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Upgrade `(ForestFunctionalLevel` </TaskDescription>
    </Id>

    <!-- SET MS-DS-MACHINEACCOUNTQUOTA TO 0                                                                                                  -->
    <Id Number="010" Name="Restrict computer junction to the domain">
      <CallingFunction>Set-msDSMachineAccountQuota</CallingFunction>
      <!--Parameter: new ms-DS-MachineAccountQuota value                                                                                     -->
      <UseParameters>0</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(msDSMachineAccountQuota` to `(0` to restrict domain junction</TaskDescription>
    </Id>

    <!-- ENABLE THE AD RECYCLE BIN                                                                                                           -->
    <Id Number="020" Name="Activate Active Directory Recycle Bin">
      <CallingFunction>Set-ADRecycleBin</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>activate the `(AD Recycle Bin` optional feature</TaskDescription>
    </Id>

    <!-- CONFIGURE ALL AD SITE LINKS WITH THE NOTIFY OPTIONS                                                                                 -->
    <Id Number="030" Name="Set Notify on every Site Links">
      <CallingFunction>Set-SiteLinkNotify</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(notify` on every `(Site Links</TaskDescription>
    </Id>

    <!-- ACTIVATE THE GPO CENTRAL STORE                                                                                                      -->
    <Id Number="040" Name="Set GPO Central Store">
      <CallingFunction>Set-GpoCentralStore</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(GPO Central Store` and update `{adm` and `{admx` files</TaskDescription>
    </Id>

    <!-- GENERATE NEW ADMINISTRATION ORGANIZATIONAL UNIT                                                                                     -->
    <Id Number="050" Name="Set Administration Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_ADMIN</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(Administration` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW TIER 0 ORGANIZATIONAL UNIT                                                                                             -->
    <Id Number="051" Name="Set Tier 0 Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_PROD-T0</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(Tier 0` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW TIER 1 and 2 ORGANIZATIONAL UNIT                                                                                       -->
    <Id Number="052" Name="Set Tier 1 and Tier 2 Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_PROD-T1and2</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(Tier 1 and Tier 2 combo` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW LEGACY ORGANIZATIONAL UNIT                                                                                             -->
    <Id Number="053" Name="Set Legacy Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>HardenAD_PROD-LEGACY</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(Tier Legacy` organizational unit</TaskDescription>
    </Id>

    <!-- GENERATE NEW DEFAULT OBJECTS LOCATION TREE                                                                                          -->
    <Id Number="060" Name="Set Provisioning Organizational Unit">
      <CallingFunction>Set-TreeOU</CallingFunction>
      <!--Parameter: class name from OrganizationalUnits | ouTree in this document                                                           -->
      <UseParameters>PROVISIONNING-EN</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(Provisioning` organizational unit</TaskDescription>
    </Id>

    <!-- RELOCATE NEW USER/GROUP OBJECT LOCATION                                                                                             -->
    <Id Number="070" Name="Default user location on creation">
      <CallingFunction>Set-DefaultObjectLocation</CallingFunction>
      <!--Parameter: user or computer                                                                                                        -->
      <UseParameters>User</UseParameters>
      <!--Parameter: OU distinguishedName. Use RootDN to automatically fill-in the domain name                                               -->
      <UseParameters>OU=users,OU=provisioning,RootDN</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(user objects` default location</TaskDescription>
    </Id>

    <!-- RELOCATE NEW COMPUTER OBJECT LOCATION                                                                                             -->
    <Id Number="071" Name="Default computer location on creation">
      <CallingFunction>Set-DefaultObjectLocation</CallingFunction>
      <!--Parameter: user or computer                                                                                                      -->
      <UseParameters>Computer</UseParameters>
      <!--Parameter: OU distinguishedName. Use RootDN to automatically fill-in the domain name                                             -->
      <UseParameters>OU=computers,OU=provisioning,RootDN</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>set `(computer objects` default location</TaskDescription>
    </Id>

    <!-- GENERATE NEW ADMIN ACCOUNTS ON WHICH THE DELEGATION MODEL WILL WORKS                                                              -->
    <Id Number="080" Name="Create administration accounts">
      <CallingFunction>New-AdministrationAccounts</CallingFunction>
      <!-- Parameter: KeePass password for the kdbx database                                                                               -->
      <UseParameters>H4rd3n@D!!</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>create `(administration accounts` used by the tier model</TaskDescription>
    </Id>

    <!-- GENERATE NEW ADMIN GROUPS ON WHICH THE DELEGATION MODEL WILL WORKS                                                                -->
    <Id Number="090" Name="Create administration groups">
      <CallingFunction>New-AdministrationGroups</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>create `(administration groups` used by the tier model</TaskDescription>
    </Id>

    <!-- ACEs DEPLOYMENT FOR DELEGATION MODEL                                                                                               -->
    <Id Number="095" Name="Enforce delegation model through ACEs">
      <CallingFunction>Push-DelegationModel</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Enforce `(Delegation ACEs` used by the tier model</TaskDescription>
    </Id>

    <!-- IMPORT WMI FILTERS                                                                                                                -->
    <Id Number="125" Name="Import additional WMI Filters">
      <CallingFunction>Import-WmiFilters</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Import `(WMI filter` to the domain</TaskDescription>
    </Id>

    <!-- LOC ADM TASK DEPLOYMENT SCRIPT UDATE                                                                                                -->
    <Id Number="127" Name="Update Loca Adm Task deployment scripts">
      <CallingFunction>Set-LocAdmTaskScripts</CallingFunction>
      <UseParameters>SYSVOL\%domaindns%\scripts\LocAdmTask</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Update `(LocAdmTask Scripts` to match with the domain name</TaskDescription>
    </Id>

    <!-- IMPORT GPOs                                                                                                                       -->
    <Id Number="130" Name="Import new GPO or update existing ones">
      <CallingFunction>New-GpoObject</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>Yes</TaskEnabled>
      <TaskDescription>Import or update `(group policy objects` to the domain and link them</TaskDescription>
    </Id>

    <!-- LAPS SCHEMA UPDATE AND POWERSHELL TOOLING DEPLOYMENT                                                                              -->
    <!-- Warning: this only works with .Net 4.0 or greater.                                                                                -->
    <Id Number="134" Name="Update Ad schema for LAPS and deploy PShell tools">
      <CallingFunction>Install-Laps</CallingFunction>
      <!-- Parameter: ForceDcIsSchemaOwner (default) will require that the running system is also the Schema Master owner                  -->
      <!--            IgnoreDcIsSchameOwner will remove this requierment (child domain, etc.)                                              -->
      <UseParameters>ForceDcIsSchemaOwner</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Update `(AD Schema` for `[LAPS` and add `(PShell add-on`</TaskDescription>
    </Id>

    <!-- LAPS PERMISSIONS DEPLOYMENT OVER THE DOMAIN                                                                                       -->
    <Id Number="135" Name="Setup LAPS permissions over the domain">
      <CallingFunction>Set-LapsPermissions</CallingFunction>
      <!-- Parameter: CUSTOM : will teach the script to apply a fine-grained definition (refering to <LocalAdminPasswordSolution>)         -->
      <!--            DEFAULT: will apply permission at the root domain level and leave domain admins as the only allowed users.           -->
      <UseParameters>CUSTOM</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Set-up `(LAPS` permissions on the target domain</TaskDescription>
    </Id>

    <!-- LAPS DEPLOYMENT SCRIPT UDATE                                                                                                      -->
    <Id Number="136" Name="Update LAPS deployment scripts">
      <CallingFunction>Set-LapsScripts</CallingFunction>
      <!-- Parameter: use NETLOGON or SYSVOL for a dynamic location. Else enter the UNC Path                                               -->
      <UseParameters>NETLOGON\LAPS</UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Update `(LAPS Scripts` to match with the domain name</TaskDescription>
    </Id>

    <!-- IMPORT SCHEDULE TASKS                                                                                                             -->
    <Id Number="140" Name="Import schedule tasks on the running system">
      <CallingFunction>New-ScheduleTasks</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Import new `(schedule tasks` to the `[running system`</TaskDescription>
    </Id>

    <!-- RESET SENSIBLE GROUPS                                                                                                             -->
    <Id Number="150" Name="Reset Group Memberships">
      <CallingFunction>Reset-GroupMembership</CallingFunction>
      <UseParameters></UseParameters>
      <TaskEnabled>No</TaskEnabled>
      <TaskDescription>Reset `(groups's membeberships` to the `[trusted list`</TaskDescription>
    </Id>
  </Sequence>
</Settings>