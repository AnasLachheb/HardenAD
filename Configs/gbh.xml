<?xml version="1.0" encoding="utf-8" ?>
<!--xml baseline for Manage-GbhAdministrationRights.ps1-->
<!--Use ROOTDN to let the script match to your domain root dynamically-->
<!--Use PRODUCTION to let the script match to your procution OU as specifiy in this file-->
<!--Use COUNTRY to let the script knows to replace with the country name-->
<!--Use SOCIETY to le the script knows to replace with the society name-->
<MODEL version="01.00" Date="26/06/2021">
  <!--BASELINE: defines the whole settings to apply to each society-->
  <BASELINE>
    <!--ADMINISTRATION: settings for Administrative OU-->
    <ADMINISTRATION Name="Admin" Path="ROOTDN">
      <OU Name="Admin Local - Servers">
        <Group Perimeter="COUNTRY" name="Local_SRV_Adm-COUNTRY" category="security" scope="global" description="Groupe d'acces aux Serveurs de COUNTRY"/>
        <Group Perimeter="SOCIETY" name="Local_SRV_Adm-COUNTRY_SOCIETY" category="security" scope="global" description="Groupe d'acces aux Serveurs de COUNTRY-SOCIETY">
          <Member>Local_SRV_Adm-COUNTRY</Member>
        </Group>
      </OU>
      <OU Name="Admin Local - Workstations">
        <Group Perimeter="COUNTRY" name="Local_WS_Adm-COUNTRY" category="security" scope="global" description="Groupe d'acces aux PC de COUNTRY"/>
        <Group Perimeter="SOCIETY" name="Local_WS_Adm-COUNTRY_SOCIETY" category="security" scope="global" description="Groupe d'acces aux PC de COUNTRY-SOCIETY">
          <Member>Local_WS_Adm-COUNTRY</Member>
          <Member>admin-sccm</Member>
        </Group>
      </OU>
      <OU Name="Admin OU - Delegation">
        <Group Perimeter="COUNTRY" name="Adm-COUNTRY" category="security" scope="global" description="Groupe d'administration de COUNTRY"/>
        <Group Perimeter="SOCIETY" name="Adm-COUNTRY_SOCIETY" category="security" scope="global" description="Groupe d'administration de  COUNTRY-SOCIETY">
          <Member>Admins-COUNTRY</Member>
          <MemberOf>Adm-GBH-All</MemberOf>
          <MemberOf>Adm-GBH-Join_Domain</MemberOf>
          <MemberOf>Adm-GBH-MSRA</MemberOf>
        </Group>
      </OU>
      <OU Name="COUNTRY">
        <OU Name="SOCIETY">
          <OU Name="Groupes">
            <Group Perimeter="COUNTRY" name="Admins-COUNTRY" category="security" scope="global" description=""/>
            <Group Perimeter="SOCIETY" name="Admins-COUNTRY_SOCIETY" category="security" scope="global" description="">
              <Member Type="group">Admins-COUNTRY</Member>
            </Group>
          </OU>
          <OU Name="Utilisateurs"/>
        </OU>
      </OU>
    </ADMINISTRATION>
    <!--PRODUCTION: settings for the production OU-->
    <PRODUCTION Name="GBH" Path="ROOTDN">
      <OU Name="COUNTRY">
        <OU Name="SOCIETY">
          <ACL Rights="UsersAndGroups" Group="Adm-COUNTRY_SOCIETY"/>
          <ACL Rights="Computers" Group="Adm-COUNTRY_SOCIETY"/>
          <OU Name="Groupes"/>
          <OU Name="Ordinateurs">
            <GPO Name="GBH Workstations" Action="CustomizeAndLink">
              <Preference xml="Groups.xml" Path="DomainSysvol\GPO\Machine\Preferences\Groups" Member="GBH\Local_WS_Adm-COUNTRY_SOCIETY" Filter="OU=Ordinateurs,OU=SOCIETY,OU=COUNTRY,OU=PRODUCTION,ROOTDN"/>
            </GPO>
          </OU>
          <OU Name="Serveurs">
            <GPO Name="GBH Servers" Action="CustomizeAndLink">
              <Preference xml="Groups.xml" Path="DomainSysvol\GPO\Machine\Preferences\Groups" Member="GBH\Local_SRV_Adm-COUNTRY_SOCIETY" Filter="OU=Serveurs,OU=SOCIETY,OU=COUNTRY,OU=PRODUCTION,ROOTDN"/>
            </GPO>
          </OU>
          <OU Name="Services"/>
          <GPO Name="GBH Users" Action="Link"/>
          <GPO Name="GBH Users - No Screenlock" Action="Link"/>
          <OU Name="Utilisateurs"/>
          <GPO Name="GBH Users" Action="Link"/>
          <GPO Name="GBH Users - No Screenlock" Action="Link"/>
        </OU>
      </OU>
    </PRODUCTION>
  </BASELINE>
  <!--ENTITIES: defines every country and society that have to be present in your AD-->
  <!--GPO use "action" to tell the script what is expected: CustomizeAndLink to edit then link the GPO, Link to just link it-->
  <!--Within the parameter <Society>, you can force the network plan to any ADSite you want by givings its name. Else, use COUNTRY to link it to the society's country-->
  <ENTITIES>
    <Country name="XXX">
      <Society NetworkAddress="1.2.3.4/24" ADSite="COUNTRY">XXXXXX</Society>
    </Country>
  </ENTITIES>
</MODEL>